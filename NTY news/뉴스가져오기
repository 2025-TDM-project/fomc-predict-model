
{
  "nbformat": 4,
  "nbformat_minor": 0,
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "name": "python3",
      "display_name": "Python 3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "7fe67a75268c403bb0c18de0f3ab8a1d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_04ffbb6d86724eec87e58a2f1c69b5f5",
              "IPY_MODEL_1257b0440e5f4524b6aa4769f6dec627",
              "IPY_MODEL_1f3f1ae217cc42f3ac9e96a94caa58ec"
            ],
            "layout": "IPY_MODEL_decb2b4483ee49228c18e3d4b6188891"
          }
        },
        "04ffbb6d86724eec87e58a2f1c69b5f5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ed6155e34cd8466287ee9a8f087fa47d",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_011e3ec966be4c129b3b096cf682e2c2",
            "value": "100%"
          }
        },
        "1257b0440e5f4524b6aa4769f6dec627": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_a071bc3a4ece448cb05338759d38b87a",
            "max": 34462,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_c558b017dc334620b228e7773d2d90fb",
            "value": 34462
          }
        },
        "1f3f1ae217cc42f3ac9e96a94caa58ec": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_fd17c211b79740c891330905e9fbd691",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_f56915ae876e48caaeb5bd9e5975a098",
            "value": "‚Äá34462/34462‚Äá[22:08&lt;00:00,‚Äá39.93it/s]"
          }
        },
        "decb2b4483ee49228c18e3d4b6188891": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "ed6155e34cd8466287ee9a8f087fa47d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "011e3ec966be4c129b3b096cf682e2c2": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "a071bc3a4ece448cb05338759d38b87a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "c558b017dc334620b228e7773d2d90fb": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "fd17c211b79740c891330905e9fbd691": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "f56915ae876e48caaeb5bd9e5975a098": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        }
      }
    }
  },
  "cells": [
    {
      "cell_type": "markdown",
      "source": [
        "## 2Ï∞® ÏàòÏ†ï ÏÑπÏÖòÏù¥ Í≤ΩÏ†ú Í∏àÏúµÏù∏ Í≤ÉÎßå ÌïÑÌÑ∞ÎßÅ\n"
      ],
      "metadata": {
        "id": "j18btk14aJSE"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "11Ïãú ÏãúÏûë"
      ],
      "metadata": {
        "id": "ymQRi0YG1Ijb"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "#ÎÖ∏ÏÜî api\n",
        "NYT_API_KEY = \"Nko9vGjj6bC3WzKnYYL0WrJwAZwtqutI\""
      ],
      "metadata": {
        "id": "qAHG0cMV1KBI"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install requests pandas python-dateutil tqdm"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "RMxBKvwI195Y",
        "outputId": "1615658f-933d-457a-dc34-9bf77b8f5782"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (2.32.4)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.12/dist-packages (2.2.2)\n",
            "Requirement already satisfied: python-dateutil in /usr/local/lib/python3.12/dist-packages (2.9.0.post0)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (4.67.1)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests) (2025.10.5)\n",
            "Requirement already satisfied: numpy>=1.26.0 in /usr/local/lib/python3.12/dist-packages (from pandas) (2.0.2)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas) (2025.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas) (2025.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil) (1.17.0)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "#Îü∞ÌÉÄÏûÑ ÏãúÏûë"
      ],
      "metadata": {
        "id": "RDumhQPLMnt4"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import os\n",
        "import time\n",
        "import json\n",
        "import requests\n",
        "import pandas as pd\n",
        "from tqdm.auto import tqdm\n",
        "from dateutil import parser as dateparser\n",
        "from datetime import datetime, timedelta, date"
      ],
      "metadata": {
        "id": "ErEpjGAy1_5u"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "1-1. API ÌÇ§, FOMC ÎÇ†Ïßú, Í∏∞Î≥∏ ÏÑ§Ï†ï"
      ],
      "metadata": {
        "id": "L5KImN7I2Gv5"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# üîê API ÌÇ§ ÏÑ§Ï†ï\n",
        "NYT_API_KEY = \"Nko9vGjj6bC3WzKnYYL0WrJwAZwtqutI\""
      ],
      "metadata": {
        "id": "dshlPeTH2CHK"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "1-2. Ï†ïÏ±Ö/Í±∞Ïãú ‚ÄúÏïΩÌïú ÌÇ§ÏõåÎìú ÌïÑÌÑ∞‚Äù (Î≥∏Î¨∏ ÏàòÏ§Ä)\n",
        "\n",
        "Ï†ïÏ±ÖÏñ¥ + ÏÉÅÍ¥Ä ÏÉÅÏúÑ Î≥ÄÏàòÏñ¥ Ï§ë ÌïòÎÇòÎùºÎèÑ Ìó§ÎìúÎùºÏù∏¬∑Î¶¨ÎìúÎ¨∏Îã®Ïóê Îì§Ïñ¥Í∞ÄÎ©¥ Ï†ÄÏû•."
      ],
      "metadata": {
        "id": "RMVX2zjK2kTP"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Ï†ïÏ±ÖÏñ¥\n",
        "POLICY_TERMS = [\n",
        "    \"interest rate\", \"interest rates\",\n",
        "    \"policy rate\", \"base rate\", \"benchmark rate\", \"key rate\",\n",
        "    \"monetary policy\", \"FOMC\", \"Federal Reserve\", \"the Fed\",\n",
        "    \"rate hike\", \"rate cut\", \"easing\", \"tightening\", \"liftoff\",\n",
        "    \"hold rates\", \"on hold\", \"unchanged\", \"pause\",\n",
        "    \"dot plot\", \"Summary of Economic Projections\", \"SEP\",\n",
        "    \"forward guidance\", \"policy guidance\", \"rate guidance\",\n",
        "]\n",
        "\n",
        "# ÏÉÅÍ¥Ä ÏÉÅÏúÑ Í±∞Ïãú Î≥ÄÏàò\n",
        "MACRO_TERMS = [\n",
        "    # >=0.7 Î≤ÑÌÇ∑ ÏòàÏãú\n",
        "    \"Treasury yield\", \"Treasury yields\", \"10-year Treasury\",\n",
        "    \"2-year Treasury\", \"T-bill\", \"mortgage rate\", \"mortgage rates\",\n",
        "    \"unemployment rate\", \"jobless rate\", \"yield curve\",\n",
        "    # 0.4~0.55 Î≤ÑÌÇ∑ ÏòàÏãú\n",
        "    \"corporate bond\", \"credit spread\",\n",
        "    \"industrial production\", \"IPI\",\n",
        "    \"housing starts\", \"building permits\",\n",
        "    \"inflation expectations\", \"breakeven inflation\", \"TIPS\",\n",
        "]\n",
        "\n",
        "# ---- Îâ¥Ïä§ Í∞ÄÏ†∏Ïò¨ Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïÑÌÑ∞ ÏÑ§Ï†ï ----\n",
        "ECON_SECTIONS = [  # Í≤ΩÏ†ú¬∑Í∏àÏúµ ÌïµÏã¨ ÏÑπÏÖò ‚Üí Í∑∏ÎÉ• Îã§ Í∞ÄÏ†∏Ïò§Í∏∞\n",
        "    \"Business\",\n",
        "    \"Business Day\",\n",
        "    \"Economy\",\n",
        "    \"Markets\",\n",
        "    \"DealBook\",\n",
        "    \"Your Money\",\n",
        "]\n",
        "\n",
        "MAYBE_SECTIONS = [  # Ïó∞Ï§Ä/Í∏àÎ¶¨ ÏñòÍ∏∞ ÏûàÏùÑ ÎïåÎßå Í∞ÄÏ†∏Ïò§Í∏∞\n",
        "    \"U.S.\",\n",
        "    \"Politics\",\n",
        "    \"World\",\n",
        "    \"Foreign\",\n",
        "]\n",
        "\n",
        "def is_relevant_by_section(section_name: str, text: str) -> bool:\n",
        "    \"\"\"\n",
        "    section_name + Í∏∞ÏÇ¨ ÎÇ¥Ïö©(text)ÏùÑ Î≥¥Í≥†\n",
        "    'FOMC/Í∏àÎ¶¨ Í¥ÄÎ†® Í∏∞ÏÇ¨Ïù∏Í∞Ä?'Î•º ÌåêÎã®.\n",
        "    \"\"\"\n",
        "    section = (section_name or \"\").strip()\n",
        "    t = text.lower()\n",
        "\n",
        "    # 1) Í≤ΩÏ†ú/Í∏àÏúµ ÏÑπÏÖòÏùÄ Í∑∏ÎÉ• ÌÜµÍ≥º\n",
        "    if section in ECON_SECTIONS:\n",
        "        return True\n",
        "\n",
        "    # 2) U.S./Politics/World Í∞ôÏùÄ ÏÑπÏÖòÏùÄ\n",
        "    #    Ïó∞Ï§Ä/FOMC/ÌÜµÌôîÏ†ïÏ±Ö/Í∏àÎ¶¨ Í¥ÄÎ†® Ï†ïÏ±ÖÏñ¥Í∞Ä Îì§Ïñ¥Í∞à ÎïåÎßå ÌÜµÍ≥º\n",
        "    if section in MAYBE_SECTIONS:\n",
        "        return contains_any(t, POLICY_TERMS)\n",
        "\n",
        "    # 3) ÎÇòÎ®∏ÏßÄ ÏÑπÏÖò (Sports, Arts, Food, Travel, ‚Ä¶) ÏùÄ Îã§ Î≤ÑÎ¶º\n",
        "    return False\n",
        "\n",
        "def contains_any(text: str, keywords):\n",
        "    t = text.lower()\n",
        "    return any(k.lower() in t for k in keywords)"
      ],
      "metadata": {
        "id": "N3xTMs8h2lDA"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "fomc_strs = '''\n",
        "\n",
        "1993-02-03, 1993-03-23, 1993-05-18, 1993-07-07, 1993-08-17, 1993-09-21, 1993-11-16, 1993-12-21,\n",
        "1994-02-04, 1994-03-22, 1994-05-17, 1994-07-06, 1994-08-16, 1994-09-27, 1994-11-15, 1994-12-20,\n",
        "1995-02-01, 1995-03-28, 1995-05-23, 1995-07-06, 1995-08-22, 1995-09-26, 1995-11-15, 1995-12-19,\n",
        "1996-01-31, 1996-03-26, 1996-05-21, 1996-07-03, 1996-08-20, 1996-09-24, 1996-11-13, 1996-12-17,\n",
        "1997-02-05, 1997-03-25, 1997-05-20, 1997-07-02, 1997-08-19, 1997-09-30, 1997-11-12, 1997-12-16,\n",
        "1998-02-04, 1998-03-31, 1998-05-19, 1998-07-01, 1998-08-18, 1998-09-29, 1998-11-17, 1998-12-22,\n",
        "1999-02-03, 1999-03-30, 1999-05-18, 1999-06-30, 1999-08-24, 1999-10-05, 1999-11-16, 1999-12-21,\n",
        "2000-02-02, 2000-03-21, 2000-05-16, 2000-06-28, 2000-08-22, 2000-10-03, 2000-11-15, 2000-12-19,\n",
        "2001-01-31, 2001-03-20, 2001-05-15, 2001-06-27, 2001-08-21, 2001-09-17, 2001-10-02, 2001-11-06, 2001-12-11,\n",
        "2002-01-30, 2002-03-19, 2002-05-07, 2002-06-26, 2002-08-13, 2002-09-24, 2002-11-06, 2002-12-10,\n",
        "2003-01-29, 2003-03-18, 2003-05-06, 2003-06-25, 2003-08-12, 2003-09-16, 2003-10-28, 2003-12-09,\n",
        "2004-01-28, 2004-03-16, 2004-05-04, 2004-06-30, 2004-08-10, 2004-09-21, 2004-11-10, 2004-12-14,\n",
        "2005-02-02, 2005-03-22, 2005-05-03, 2005-06-30, 2005-08-09, 2005-09-20, 2005-11-01, 2005-12-13,\n",
        "2006-01-31, 2006-03-28, 2006-05-10, 2006-06-29, 2006-08-08, 2006-09-20, 2006-10-25, 2006-12-12,\n",
        "2007-01-31, 2007-03-21, 2007-05-09, 2007-06-28, 2007-08-07, 2007-09-18, 2007-10-31, 2007-12-11,\n",
        "2008-01-30, 2008-03-18, 2008-04-30, 2008-06-25, 2008-08-05, 2008-09-16, 2008-10-08, 2008-10-29, 2008-12-16,\n",
        "2009-01-28, 2009-03-18, 2009-04-29, 2009-06-24, 2009-08-12, 2009-09-23, 2009-11-04, 2009-12-16,\n",
        "2010-01-27, 2010-03-16, 2010-04-28, 2010-06-23, 2010-08-10, 2010-09-21, 2010-11-03, 2010-12-14,\n",
        "2011-01-26, 2011-03-15, 2011-04-27, 2011-06-22, 2011-08-09, 2011-09-21, 2011-11-02, 2011-12-13,\n",
        "2012-01-25, 2012-03-13, 2012-04-25, 2012-06-20, 2012-07-31, 2012-09-13, 2012-10-24, 2012-12-12,\n",
        "2013-01-30, 2013-03-20, 2013-05-01, 2013-06-19, 2013-07-31, 2013-09-18, 2013-10-30, 2013-12-18,\n",
        "2014-01-29, 2014-03-19, 2014-04-30, 2014-06-18, 2014-07-30, 2014-09-17, 2014-10-29, 2014-12-17,\n",
        "2015-01-28, 2015-03-18, 2015-04-29, 2015-06-17, 2015-07-29, 2015-09-17, 2015-10-28, 2015-12-16,\n",
        "2016-01-27, 2016-03-16, 2016-04-27, 2016-06-15, 2016-07-27, 2016-09-21, 2016-11-02, 2016-12-14,\n",
        "2017-02-01, 2017-03-15, 2017-05-03, 2017-06-14, 2017-07-26, 2017-09-20, 2017-11-01, 2017-12-13,\n",
        "2018-01-31, 2018-03-21, 2018-05-02, 2018-06-13, 2018-08-01, 2018-09-26, 2018-11-08, 2018-12-19,\n",
        "2019-01-30, 2019-03-20, 2019-05-01, 2019-06-19, 2019-07-31, 2019-09-18, 2019-10-30, 2019-12-11,\n",
        "2020-01-29, 2020-03-03, 2020-03-15, 2020-04-29, 2020-06-10, 2020-07-29, 2020-09-16, 2020-11-05, 2020-12-16,\n",
        "2021-01-27, 2021-03-17, 2021-04-28, 2021-06-16, 2021-07-28, 2021-09-22, 2021-11-03, 2021-12-15,\n",
        "2022-01-26, 2022-03-16, 2022-05-04, 2022-06-15, 2022-07-27, 2022-09-21, 2022-11-02, 2022-12-14,\n",
        "2023-02-01, 2023-03-22, 2023-05-03, 2023-06-14, 2023-07-26, 2023-09-20, 2023-11-01, 2023-12-13,\n",
        "2024-01-31, 2024-03-20, 2024-05-01, 2024-06-12, 2024-07-31, 2024-09-18, 2024-11-06, 2024-12-18,\n",
        "2025-01-29, 2025-03-19, 2025-05-07, 2025-06-18, 2025-07-30, 2025-09-17\n",
        "'''\n",
        "\n",
        "# Split the string by commas and newlines, strip whitespace, and filter out empty strings\n",
        "FOMC_DATES = {date.fromisoformat(d.strip()) for d in fomc_strs.split(',') if d.strip()}\n",
        "\n",
        "FOMC_WINDOW_DAYS = 3  # ¬±3Ïùº"
      ],
      "metadata": {
        "id": "yiEuAbC04KWR"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "1-3. FOMC ¬±3Ïùº ÏúàÎèÑÏö∞ Ï≤¥ÌÅ¨ Ìï®Ïàò"
      ],
      "metadata": {
        "id": "I3-G8qWU2oHQ"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "def in_fomc_window(pub_dt: date, window_days: int = FOMC_WINDOW_DAYS) -> bool:\n",
        "    for d in FOMC_DATES:\n",
        "        if abs((pub_dt - d).days) <= window_days:\n",
        "            return True\n",
        "    return False"
      ],
      "metadata": {
        "id": "8ICTYYt22oro"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "1-4. NYT Archive API Ìò∏Ï∂ú + ÌïÑÌÑ∞ÎßÅ"
      ],
      "metadata": {
        "id": "q9Vz54Sq2p3U"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "def fetch_nyt_archive(year: int, month: int):\n",
        "    url = f\"https://api.nytimes.com/svc/archive/v1/{year}/{month}.json\"\n",
        "    params = {\"api-key\": NYT_API_KEY}\n",
        "\n",
        "    for attempt in range(5):\n",
        "        try:\n",
        "            r = requests.get(url, params=params, timeout=30)\n",
        "            if r.status_code == 429:\n",
        "                print(\"  ‚Üí 429 Too Many Requests, waiting 15 sec...\")\n",
        "                time.sleep(15)\n",
        "                continue\n",
        "\n",
        "            r.raise_for_status()\n",
        "            return r.json()\n",
        "\n",
        "        except Exception as e:\n",
        "            print(f\"  ERROR ({year}-{month:02d}) attempt {attempt+1}: {e}\")\n",
        "            time.sleep(10)\n",
        "\n",
        "    print(f\"  [SKIP] {year}-{month:02d} failed too many times.\")\n",
        "    return None"
      ],
      "metadata": {
        "id": "EiIKQ1wj2qwB"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "4. ÌïµÏã¨ Ìï®Ïàò: run_nyt_archive_chunk(START_YEAR, END_YEAR)\n",
        "\n",
        "Ïù¥ Ìï®ÏàòÎßå Ïã§ÌñâÌïòÎ©¥ Îê®.\n",
        "Ïã§Ìñâ Ïãú:\n",
        "\t‚Ä¢\tÏõîÎ≥Ñ Archive Ìò∏Ï∂ú\n",
        "\t‚Ä¢\tFOMC ÏúàÎèÑÏö∞ ÌïÑÌÑ∞\n",
        "\t‚Ä¢\tÏ†ïÏ±ÖÏñ¥/Í±∞ÏãúÏñ¥ ÏïΩÌïú ÌïÑÌÑ∞\n",
        "\t‚Ä¢\tpartial Ï†ÄÏû•\n",
        "\t‚Ä¢\tÎßàÏßÄÎßâÏóê chunk csv Ï†ÄÏû•"
      ],
      "metadata": {
        "id": "tQzRUqNl4eCa"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "def run_nyt_archive_chunk(START_YEAR: int, END_YEAR: int):\n",
        "    print(f\"\\n==============================\")\n",
        "    print(f\" NYT ARCHIVE CHUNK: {START_YEAR} ~ {END_YEAR}\")\n",
        "    print(f\"==============================\\n\")\n",
        "\n",
        "    raw_rows = []\n",
        "\n",
        "    for year in range(START_YEAR, END_YEAR + 1):\n",
        "        print(f\"=== YEAR {year} ===\")\n",
        "\n",
        "        for month in range(1, 13):\n",
        "            print(f\" Fetching {year}-{month:02d} ...\")\n",
        "\n",
        "            data = fetch_nyt_archive(year, month)\n",
        "            if data is None:\n",
        "                continue\n",
        "\n",
        "            docs = data.get(\"response\", {}).get(\"docs\", [])\n",
        "            print(f\"  docs: {len(docs)}\")\n",
        "\n",
        "            for i, doc in enumerate(docs):\n",
        "                # ---- Í∏∞Î≥∏ ÌïÑÎìú ----\n",
        "                pub_date_str = doc.get(\"pub_date\")\n",
        "                if not pub_date_str:\n",
        "                    continue\n",
        "\n",
        "                pub_dt = dateparser.parse(pub_date_str).date()\n",
        "\n",
        "                # ---- FOMC ¬±3Ïùº ÌïÑÌÑ∞ ----\n",
        "                if not in_fomc_window(pub_dt):\n",
        "                    continue\n",
        "\n",
        "                # ---- Ïñ∏Ïñ¥/ÌÉÄÏûÖ ÌïÑÌÑ∞ ----\n",
        "                language = doc.get(\"language\", \"en\")\n",
        "                if language not in (\"en\", \"English\"):\n",
        "                    continue\n",
        "\n",
        "                if doc.get(\"document_type\") != \"article\":\n",
        "                    continue\n",
        "\n",
        "                source = doc.get(\"source\", \"\")\n",
        "                if source not in [\"The New York Times\", \"Reuters\", \"AP\"]:\n",
        "                    continue\n",
        "\n",
        "                mat = doc.get(\"type_of_material\", \"\")\n",
        "                if mat in [\"Letter\", \"Obituary\", \"Paid Death Notice\"]:\n",
        "                    continue\n",
        "\n",
        "\n",
        "                                # ---- ÌÖçÏä§Ìä∏ Íµ¨ÏÑ± ----\n",
        "                h = (doc.get(\"headline\") or {}).get(\"main\", \"\") or \"\"\n",
        "                lp = doc.get(\"lead_paragraph\") or \"\"\n",
        "                ab = doc.get(\"abstract\") or \"\"\n",
        "                sn = doc.get(\"snippet\") or \"\"\n",
        "\n",
        "                # ---- Ï†úÎ™© ÌïÑÌÑ∞: Key Rates Ï†úÍ±∞ ----\n",
        "                if h.strip().lower() == \"key rates\":\n",
        "                    continue\n",
        "\n",
        "                combined = \" \".join([h, lp, ab, sn]).strip()\n",
        "                if not combined:\n",
        "                    continue\n",
        "\n",
        "                combined_lower = combined.lower()\n",
        "\n",
        "\n",
        "\n",
        "                # ---- ÏÑπÏÖò + ÎÇ¥Ïö© ÌïÑÌÑ∞ ----\n",
        "                section_name = doc.get(\"section_name\", \"\") or \"\"\n",
        "                if not is_relevant_by_section(section_name, combined_lower):\n",
        "                    # Í≤ΩÏ†ú/Í∏àÏúµ ÏÑπÏÖòÏù¥ ÏïÑÎãàÍ±∞ÎÇò,\n",
        "                    # U.S./Politics/WorldÏù∏Îç∞ÎèÑ Ï†ïÏ±ÖÏñ¥Í∞Ä ÏóÜÏúºÎ©¥ Î≤ÑÎ¶º\n",
        "                    continue\n",
        "\n",
        "                # ---- ÌÇ§ÏõåÎìú ÌïÑÌÑ∞ (A + B ÎèôÏãú Îì±Ïû•) ----\n",
        "                has_policy = contains_any(combined_lower, POLICY_TERMS)\n",
        "                has_macro  = contains_any(combined_lower, MACRO_TERMS)\n",
        "\n",
        "                # Ï†ïÏ±ÖÏñ¥ÏôÄ ÏÉÅÍ¥Ä ÏÉÅÏúÑ Í±∞ÏãúÎ≥ÄÏàòÍ∞Ä\n",
        "                # Í∞ôÏùÄ Î¨∏ÏÑú ÏïàÏóê Îëò Îã§ ÏûàÏñ¥ÏïºÎßå ÌÜµÍ≥º\n",
        "                if not (has_policy and has_macro):\n",
        "                    continue\n",
        "\n",
        "\n",
        "                # ---- doc_id ÏÉùÏÑ± ----\n",
        "                doc_id = f\"NEWS_{pub_dt.isoformat()}_{i:04d}\"\n",
        "\n",
        "                raw_rows.append({\n",
        "                    \"doc_id\": doc_id,\n",
        "                    \"doc_type\": \"news\",\n",
        "                    \"date\": pub_dt.isoformat(),\n",
        "                    \"title\": h,\n",
        "                    \"source\": source,\n",
        "                    \"language\": \"en\",\n",
        "                    \"raw_text\": combined,\n",
        "                    \"web_url\": doc.get(\"web_url\", \"\"),\n",
        "                    \"section_name\": doc.get(\"section_name\", \"\"),\n",
        "                    \"news_desk\": doc.get(\"news_desk\", \"\"),\n",
        "                })\n",
        "\n",
        "            # ---- Ïä¨Î¶Ω ‚Üí rate limit ÏôÑÌôî ----\n",
        "            time.sleep(10)\n",
        "\n",
        "        # ---- Ïó∞Îã®ÏúÑ partial save ----\n",
        "        df_partial = pd.DataFrame(raw_rows)\n",
        "        df_partial.to_csv(f\"nyt_raw_partial_{START_YEAR}_{year}.csv\", index=False)\n",
        "        print(f\"[SAVE] nyt_raw_partial_{START_YEAR}_{year}.csv ‚Üí {len(df_partial)} rows\")\n",
        "\n",
        "    # ---- chunk Ï†ÑÏ≤¥ Ï†ÄÏû• ----\n",
        "    df = pd.DataFrame(raw_rows)\n",
        "    outname = f\"nyt_raw_{START_YEAR}_{END_YEAR}.csv\"\n",
        "    df.to_csv(outname, index=False)\n",
        "    print(f\"\\n[FINISHED] Saved ‚Üí {outname} ({len(df)} rows)\\n\")\n",
        "\n",
        "    return df"
      ],
      "metadata": {
        "id": "xd1iy57u4Z3a"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "run_nyt_archive_chunk(1993, 1998)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "99sRIquD65NR",
        "outputId": "49717e10-9997-4750-9122-9729dfbbdd5b"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "==============================\n",
            " NYT ARCHIVE CHUNK: 1993 ~ 1998\n",
            "==============================\n",
            "\n",
            "=== YEAR 1993 ===\n",
            " Fetching 1993-01 ...\n",
            "  docs: 7340\n",
            " Fetching 1993-02 ...\n",
            "  docs: 6575\n",
            " Fetching 1993-03 ...\n",
            "  docs: 6062\n",
            " Fetching 1993-04 ...\n",
            "  docs: 6748\n",
            " Fetching 1993-05 ...\n",
            "  docs: 7153\n",
            " Fetching 1993-06 ...\n",
            "  docs: 6530\n",
            " Fetching 1993-07 ...\n",
            "  docs: 6805\n",
            " Fetching 1993-08 ...\n",
            "  docs: 7115\n",
            " Fetching 1993-09 ...\n",
            "  docs: 6056\n",
            " Fetching 1993-10 ...\n",
            "  docs: 8068\n",
            " Fetching 1993-11 ...\n",
            "  docs: 7182\n",
            " Fetching 1993-12 ...\n",
            "  docs: 6386\n",
            "[SAVE] nyt_raw_partial_1993_1993.csv ‚Üí 15 rows\n",
            "=== YEAR 1994 ===\n",
            " Fetching 1994-01 ...\n",
            "  docs: 6856\n",
            " Fetching 1994-02 ...\n",
            "  docs: 5934\n",
            " Fetching 1994-03 ...\n",
            "  docs: 6512\n",
            " Fetching 1994-04 ...\n",
            "  docs: 6642\n",
            " Fetching 1994-05 ...\n",
            "  docs: 7177\n",
            " Fetching 1994-06 ...\n",
            "  docs: 6249\n",
            " Fetching 1994-07 ...\n",
            "  docs: 6925\n",
            " Fetching 1994-08 ...\n",
            "  docs: 6662\n",
            " Fetching 1994-09 ...\n",
            "  docs: 6149\n",
            " Fetching 1994-10 ...\n",
            "  docs: 7352\n",
            " Fetching 1994-11 ...\n",
            "  docs: 6892\n",
            " Fetching 1994-12 ...\n",
            "  docs: 6106\n",
            "[SAVE] nyt_raw_partial_1993_1994.csv ‚Üí 26 rows\n",
            "=== YEAR 1995 ===\n",
            " Fetching 1995-01 ...\n",
            "  docs: 7038\n",
            " Fetching 1995-02 ...\n",
            "  docs: 5695\n",
            " Fetching 1995-03 ...\n",
            "  docs: 6695\n",
            " Fetching 1995-04 ...\n",
            "  docs: 7527\n",
            " Fetching 1995-05 ...\n",
            "  docs: 7062\n",
            " Fetching 1995-06 ...\n",
            "  docs: 6581\n",
            " Fetching 1995-07 ...\n",
            "  docs: 7556\n",
            " Fetching 1995-08 ...\n",
            "  docs: 7061\n",
            " Fetching 1995-09 ...\n",
            "  docs: 6351\n",
            " Fetching 1995-10 ...\n",
            "  docs: 9715\n",
            " Fetching 1995-11 ...\n",
            "  docs: 6803\n",
            " Fetching 1995-12 ...\n",
            "  docs: 7151\n",
            "[SAVE] nyt_raw_partial_1993_1995.csv ‚Üí 37 rows\n",
            "=== YEAR 1996 ===\n",
            " Fetching 1996-01 ...\n",
            "  docs: 6829\n",
            " Fetching 1996-02 ...\n",
            "  docs: 6605\n",
            " Fetching 1996-03 ...\n",
            "  docs: 7178\n",
            " Fetching 1996-04 ...\n",
            "  docs: 6705\n",
            " Fetching 1996-05 ...\n",
            "  docs: 6902\n",
            " Fetching 1996-06 ...\n",
            "  docs: 7034\n",
            " Fetching 1996-07 ...\n",
            "  docs: 6992\n",
            " Fetching 1996-08 ...\n",
            "  docs: 6010\n",
            " Fetching 1996-09 ...\n",
            "  docs: 6387\n",
            " Fetching 1996-10 ...\n",
            "  docs: 6675\n",
            " Fetching 1996-11 ...\n",
            "  docs: 6214\n",
            " Fetching 1996-12 ...\n",
            "  docs: 6258\n",
            "[SAVE] nyt_raw_partial_1993_1996.csv ‚Üí 50 rows\n",
            "=== YEAR 1997 ===\n",
            " Fetching 1997-01 ...\n",
            "  docs: 7282\n",
            " Fetching 1997-02 ...\n",
            "  docs: 6967\n",
            " Fetching 1997-03 ...\n",
            "  docs: 7647\n",
            " Fetching 1997-04 ...\n",
            "  docs: 7386\n",
            " Fetching 1997-05 ...\n",
            "  docs: 7398\n",
            " Fetching 1997-06 ...\n",
            "  docs: 7427\n",
            " Fetching 1997-07 ...\n",
            "  docs: 7120\n",
            " Fetching 1997-08 ...\n",
            "  docs: 7296\n",
            " Fetching 1997-09 ...\n",
            "  docs: 7580\n",
            " Fetching 1997-10 ...\n",
            "  docs: 8280\n",
            " Fetching 1997-11 ...\n",
            "  docs: 7893\n",
            " Fetching 1997-12 ...\n",
            "  docs: 7742\n",
            "[SAVE] nyt_raw_partial_1993_1997.csv ‚Üí 60 rows\n",
            "=== YEAR 1998 ===\n",
            " Fetching 1998-01 ...\n",
            "  docs: 7825\n",
            " Fetching 1998-02 ...\n",
            "  docs: 7147\n",
            " Fetching 1998-03 ...\n",
            "  docs: 8137\n",
            " Fetching 1998-04 ...\n",
            "  docs: 7669\n",
            " Fetching 1998-05 ...\n",
            "  docs: 8089\n",
            " Fetching 1998-06 ...\n",
            "  docs: 7628\n",
            " Fetching 1998-07 ...\n",
            "  docs: 7579\n",
            " Fetching 1998-08 ...\n",
            "  docs: 7730\n",
            " Fetching 1998-09 ...\n",
            "  docs: 7805\n",
            " Fetching 1998-10 ...\n",
            "  docs: 8314\n",
            " Fetching 1998-11 ...\n",
            "  docs: 8422\n",
            " Fetching 1998-12 ...\n",
            "  docs: 7899\n",
            "[SAVE] nyt_raw_partial_1993_1998.csv ‚Üí 112 rows\n",
            "\n",
            "[FINISHED] Saved ‚Üí nyt_raw_1993_1998.csv (112 rows)\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                   doc_id doc_type        date  \\\n",
              "0    NEWS_1993-02-06_1177     news  1993-02-06   \n",
              "1    NEWS_1993-02-06_1198     news  1993-02-06   \n",
              "2    NEWS_1993-05-15_3521     news  1993-05-15   \n",
              "3    NEWS_1993-07-08_1460     news  1993-07-08   \n",
              "4    NEWS_1993-08-20_4857     news  1993-08-20   \n",
              "..                    ...      ...         ...   \n",
              "107  NEWS_1998-12-21_5614     news  1998-12-21   \n",
              "108  NEWS_1998-12-22_5705     news  1998-12-22   \n",
              "109  NEWS_1998-12-23_6063     news  1998-12-23   \n",
              "110  NEWS_1998-12-24_6282     news  1998-12-24   \n",
              "111  NEWS_1998-12-25_6382     news  1998-12-25   \n",
              "\n",
              "                                                 title              source  \\\n",
              "0    JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...  The New York Times   \n",
              "1                                      BUSINESS DIGEST  The New York Times   \n",
              "2                        U.S. Industry's Sluggish Pace  The New York Times   \n",
              "3                       Treasury Yields Stay Near Lows  The New York Times   \n",
              "4                    U.S. Tries To Halt Fall Of Dollar  The New York Times   \n",
              "..                                                 ...                 ...   \n",
              "107                          The Votes for Impeachment  The New York Times   \n",
              "108                                          Key Rates  The New York Times   \n",
              "109                                          Key Rates  The New York Times   \n",
              "110                                          Key Rates  The New York Times   \n",
              "111                                          Key Rates  The New York Times   \n",
              "\n",
              "    language                                           raw_text  \\\n",
              "0         en  JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...   \n",
              "1         en  BUSINESS DIGEST The Economy   The Economy   Ne...   \n",
              "2         en  U.S. Industry's Sluggish Pace People have been...   \n",
              "3         en  Treasury Yields Stay Near Lows Interest rates ...   \n",
              "4         en  U.S. Tries To Halt Fall Of Dollar The Clinton ...   \n",
              "..       ...                                                ...   \n",
              "107       en  The Votes for Impeachment District Article 1 A...   \n",
              "108       en  Key Rates In percent In percent              P...   \n",
              "109       en  Key Rates In percent In percent              P...   \n",
              "110       en  Key Rates In percent In percent              P...   \n",
              "111       en  Key Rates In percent In percent              P...   \n",
              "\n",
              "                                               web_url  section_name  \\\n",
              "0    https://www.nytimes.com/1993/02/06/business/jo...  Business Day   \n",
              "1    https://www.nytimes.com/1993/02/06/business/bu...  Business Day   \n",
              "2    https://www.nytimes.com/1993/05/15/business/us...  Business Day   \n",
              "3    https://www.nytimes.com/1993/07/08/business/cr...  Business Day   \n",
              "4    https://www.nytimes.com/1993/08/20/business/cu...  Business Day   \n",
              "..                                                 ...           ...   \n",
              "107  https://www.nytimes.com/1998/12/21/us/impeachm...          U.S.   \n",
              "108  https://www.nytimes.com/1998/12/22/business/th...  Business Day   \n",
              "109  https://www.nytimes.com/1998/12/23/business/th...  Business Day   \n",
              "110  https://www.nytimes.com/1998/12/24/business/th...  Business Day   \n",
              "111  https://www.nytimes.com/1998/12/25/business/th...  Business Day   \n",
              "\n",
              "                   news_desk  \n",
              "0             Financial Desk  \n",
              "1             Financial Desk  \n",
              "2             Financial Desk  \n",
              "3             Financial Desk  \n",
              "4             Financial Desk  \n",
              "..                       ...  \n",
              "107            National Desk  \n",
              "108  Business/Financial Desk  \n",
              "109  Business/Financial Desk  \n",
              "110  Business/Financial Desk  \n",
              "111  Business/Financial Desk  \n",
              "\n",
              "[112 rows x 10 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-87e148e2-4b7d-4173-a97e-3f61eee6679a\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_1993-02-06_1177</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-02-06</td>\n",
              "      <td>JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...</td>\n",
              "      <td>https://www.nytimes.com/1993/02/06/business/jo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_1993-02-06_1198</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-02-06</td>\n",
              "      <td>BUSINESS DIGEST</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>BUSINESS DIGEST The Economy   The Economy   Ne...</td>\n",
              "      <td>https://www.nytimes.com/1993/02/06/business/bu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_1993-05-15_3521</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-05-15</td>\n",
              "      <td>U.S. Industry's Sluggish Pace</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>U.S. Industry's Sluggish Pace People have been...</td>\n",
              "      <td>https://www.nytimes.com/1993/05/15/business/us...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_1993-07-08_1460</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-07-08</td>\n",
              "      <td>Treasury Yields Stay Near Lows</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Treasury Yields Stay Near Lows Interest rates ...</td>\n",
              "      <td>https://www.nytimes.com/1993/07/08/business/cr...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_1993-08-20_4857</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-08-20</td>\n",
              "      <td>U.S. Tries To Halt Fall Of Dollar</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>U.S. Tries To Halt Fall Of Dollar The Clinton ...</td>\n",
              "      <td>https://www.nytimes.com/1993/08/20/business/cu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>107</th>\n",
              "      <td>NEWS_1998-12-21_5614</td>\n",
              "      <td>news</td>\n",
              "      <td>1998-12-21</td>\n",
              "      <td>The Votes for Impeachment</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Votes for Impeachment District Article 1 A...</td>\n",
              "      <td>https://www.nytimes.com/1998/12/21/us/impeachm...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>108</th>\n",
              "      <td>NEWS_1998-12-22_5705</td>\n",
              "      <td>news</td>\n",
              "      <td>1998-12-22</td>\n",
              "      <td>Key Rates</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Key Rates In percent In percent              P...</td>\n",
              "      <td>https://www.nytimes.com/1998/12/22/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>109</th>\n",
              "      <td>NEWS_1998-12-23_6063</td>\n",
              "      <td>news</td>\n",
              "      <td>1998-12-23</td>\n",
              "      <td>Key Rates</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Key Rates In percent In percent              P...</td>\n",
              "      <td>https://www.nytimes.com/1998/12/23/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>110</th>\n",
              "      <td>NEWS_1998-12-24_6282</td>\n",
              "      <td>news</td>\n",
              "      <td>1998-12-24</td>\n",
              "      <td>Key Rates</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Key Rates In percent In percent              P...</td>\n",
              "      <td>https://www.nytimes.com/1998/12/24/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>111</th>\n",
              "      <td>NEWS_1998-12-25_6382</td>\n",
              "      <td>news</td>\n",
              "      <td>1998-12-25</td>\n",
              "      <td>Key Rates</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Key Rates In percent In percent              P...</td>\n",
              "      <td>https://www.nytimes.com/1998/12/25/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>112 rows √ó 10 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-87e148e2-4b7d-4173-a97e-3f61eee6679a')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-87e148e2-4b7d-4173-a97e-3f61eee6679a button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-87e148e2-4b7d-4173-a97e-3f61eee6679a');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-93982c9e-9137-4da7-b365-88d7c4488fbb\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-93982c9e-9137-4da7-b365-88d7c4488fbb')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-93982c9e-9137-4da7-b365-88d7c4488fbb button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"run_nyt_archive_chunk(1993, 1998)\",\n  \"rows\": 112,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 112,\n        \"samples\": [\n          \"NEWS_1996-07-06_0982\",\n          \"NEWS_1998-03-28_7078\",\n          \"NEWS_1993-08-20_4857\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 90,\n        \"samples\": [\n          \"1997-02-07\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 64,\n        \"samples\": [\n          \"New Plan for Junk E-Mail Is Dividing Internet Camps\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 112,\n        \"samples\": [\n          \"INTERNATIONAL BRIEFS;Canada Unemployment Climbs to 20-Month High Canada's unemployment rate reached a 20-month high of 10 percent in June, Government figures showed yesterday. Economists had expected the jobless rate would be unchanged at 9.4 percent. Canada's unemployment rate reached a 20-month high of 10 percent in June, Government figures showed yesterday. Economists had expected the jobless rate would be unchanged at 9.4 percent.          The abrupt change in unemployment stemmed from an influx into the market of  36,000 people looking for jobs, increasing the labor force to more than 15 million.   (Bloomberg Business News)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 112,\n        \"samples\": [\n          \"https://www.nytimes.com/1996/07/06/business/international-briefs-canada-unemployment-climbs-to-20-month-high.html\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"Business Day\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"National Desk\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 10
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "run_nyt_archive_chunk(1999, 2004)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "n0W5id_IDK6Y",
        "outputId": "a006e62b-d0ec-4b4c-a07a-37cd78becd9f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "==============================\n",
            " NYT ARCHIVE CHUNK: 1999 ~ 2004\n",
            "==============================\n",
            "\n",
            "=== YEAR 1999 ===\n",
            " Fetching 1999-01 ...\n",
            "  docs: 8588\n",
            " Fetching 1999-02 ...\n",
            "  docs: 7439\n",
            " Fetching 1999-03 ...\n",
            "  docs: 8372\n",
            " Fetching 1999-04 ...\n",
            "  docs: 7879\n",
            " Fetching 1999-05 ...\n",
            "  docs: 8031\n",
            " Fetching 1999-06 ...\n",
            "  docs: 8382\n",
            " Fetching 1999-07 ...\n",
            "  docs: 7821\n",
            " Fetching 1999-08 ...\n",
            "  docs: 7755\n",
            " Fetching 1999-09 ...\n",
            "  docs: 7575\n",
            " Fetching 1999-10 ...\n",
            "  docs: 8511\n",
            " Fetching 1999-11 ...\n",
            "  docs: 7874\n",
            " Fetching 1999-12 ...\n",
            "  docs: 8034\n",
            "[SAVE] nyt_raw_partial_1999_1999.csv ‚Üí 7 rows\n",
            "=== YEAR 2000 ===\n",
            " Fetching 2000-01 ...\n",
            "  docs: 8502\n",
            " Fetching 2000-02 ...\n",
            "  docs: 7953\n",
            " Fetching 2000-03 ...\n",
            "  docs: 8482\n",
            " Fetching 2000-04 ...\n",
            "  docs: 8231\n",
            " Fetching 2000-05 ...\n",
            "  docs: 8331\n",
            " Fetching 2000-06 ...\n",
            "  docs: 8193\n",
            " Fetching 2000-07 ...\n",
            "  docs: 8215\n",
            " Fetching 2000-08 ...\n",
            "  docs: 8131\n",
            " Fetching 2000-09 ...\n",
            "  docs: 9736\n",
            " Fetching 2000-10 ...\n",
            "  docs: 9966\n",
            " Fetching 2000-11 ...\n",
            "  docs: 8635\n",
            " Fetching 2000-12 ...\n",
            "  docs: 8425\n",
            "[SAVE] nyt_raw_partial_1999_2000.csv ‚Üí 21 rows\n",
            "=== YEAR 2001 ===\n",
            " Fetching 2001-01 ...\n",
            "  docs: 9180\n",
            " Fetching 2001-02 ...\n",
            "  docs: 8230\n",
            " Fetching 2001-03 ...\n",
            "  docs: 8978\n",
            " Fetching 2001-04 ...\n",
            "  docs: 8788\n",
            " Fetching 2001-05 ...\n",
            "  docs: 9649\n",
            " Fetching 2001-06 ...\n",
            "  docs: 9215\n",
            " Fetching 2001-07 ...\n",
            "  docs: 9058\n",
            " Fetching 2001-08 ...\n",
            "  docs: 9214\n",
            " Fetching 2001-09 ...\n",
            "  docs: 9482\n",
            " Fetching 2001-10 ...\n",
            "  docs: 10168\n",
            " Fetching 2001-11 ...\n",
            "  docs: 9667\n",
            " Fetching 2001-12 ...\n",
            "  docs: 9683\n",
            "[SAVE] nyt_raw_partial_1999_2001.csv ‚Üí 49 rows\n",
            "=== YEAR 2002 ===\n",
            " Fetching 2002-01 ...\n",
            "  docs: 9147\n",
            " Fetching 2002-02 ...\n",
            "  docs: 8535\n",
            " Fetching 2002-03 ...\n",
            "  docs: 8902\n",
            " Fetching 2002-04 ...\n",
            "  docs: 10616\n",
            " Fetching 2002-05 ...\n",
            "  docs: 9260\n",
            " Fetching 2002-06 ...\n",
            "  docs: 9268\n",
            " Fetching 2002-07 ...\n",
            "  docs: 8580\n",
            " Fetching 2002-08 ...\n",
            "  docs: 8487\n",
            " Fetching 2002-09 ...\n",
            "  docs: 9272\n",
            " Fetching 2002-10 ...\n",
            "  docs: 9713\n",
            " Fetching 2002-11 ...\n",
            "  docs: 9115\n",
            " Fetching 2002-12 ...\n",
            "  docs: 9155\n",
            "[SAVE] nyt_raw_partial_1999_2002.csv ‚Üí 64 rows\n",
            "=== YEAR 2003 ===\n",
            " Fetching 2003-01 ...\n",
            "  docs: 9213\n",
            " Fetching 2003-02 ...\n",
            "  docs: 8603\n",
            " Fetching 2003-03 ...\n",
            "  docs: 9766\n",
            " Fetching 2003-04 ...\n",
            "  docs: 9351\n",
            " Fetching 2003-05 ...\n",
            "  docs: 9157\n",
            " Fetching 2003-06 ...\n",
            "  docs: 9173\n",
            " Fetching 2003-07 ...\n",
            "  docs: 8568\n",
            " Fetching 2003-08 ...\n",
            "  docs: 8701\n",
            " Fetching 2003-09 ...\n",
            "  docs: 8555\n",
            " Fetching 2003-10 ...\n",
            "  docs: 9204\n",
            " Fetching 2003-11 ...\n",
            "  docs: 9034\n",
            " Fetching 2003-12 ...\n",
            "  docs: 8747\n",
            "[SAVE] nyt_raw_partial_1999_2003.csv ‚Üí 89 rows\n",
            "=== YEAR 2004 ===\n",
            " Fetching 2004-01 ...\n",
            "  docs: 8810\n",
            " Fetching 2004-02 ...\n",
            "  docs: 8750\n",
            " Fetching 2004-03 ...\n",
            "  docs: 8986\n",
            " Fetching 2004-04 ...\n",
            "  docs: 8519\n",
            " Fetching 2004-05 ...\n",
            "  docs: 8899\n",
            " Fetching 2004-06 ...\n",
            "  docs: 8436\n",
            " Fetching 2004-07 ...\n",
            "  docs: 8696\n",
            " Fetching 2004-08 ...\n",
            "  docs: 8682\n",
            " Fetching 2004-09 ...\n",
            "  docs: 9131\n",
            " Fetching 2004-10 ...\n",
            "  docs: 10876\n",
            " Fetching 2004-11 ...\n",
            "  docs: 8997\n",
            " Fetching 2004-12 ...\n",
            "  docs: 9165\n",
            "[SAVE] nyt_raw_partial_1999_2004.csv ‚Üí 110 rows\n",
            "\n",
            "[FINISHED] Saved ‚Üí nyt_raw_1999_2004.csv (110 rows)\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                   doc_id doc_type        date  \\\n",
              "0    NEWS_1999-02-06_1267     news  1999-02-06   \n",
              "1    NEWS_1999-04-02_0383     news  1999-04-02   \n",
              "2    NEWS_1999-07-02_0499     news  1999-07-02   \n",
              "3    NEWS_1999-07-03_0702     news  1999-07-03   \n",
              "4    NEWS_1999-08-26_6459     news  1999-08-26   \n",
              "..                    ...      ...         ...   \n",
              "105  NEWS_2004-09-24_7172     news  2004-09-24   \n",
              "106  NEWS_2004-11-09_2710     news  2004-11-09   \n",
              "107  NEWS_2004-11-11_3112     news  2004-11-11   \n",
              "108  NEWS_2004-12-12_3398     news  2004-12-12   \n",
              "109  NEWS_2004-12-15_4658     news  2004-12-15   \n",
              "\n",
              "                                                 title              source  \\\n",
              "0                                      BUSINESS DIGEST  The New York Times   \n",
              "1         Mortgage Costs Could Ambush the U.S. Economy  The New York Times   \n",
              "2    Despite Upturn in Rates, Dow Still Gains 95.62...  The New York Times   \n",
              "3    After a Month's Lull, Employers Report Strong ...  The New York Times   \n",
              "4          Traders Bet Fed Is Done With Rate Increases  The New York Times   \n",
              "..                                                 ...                 ...   \n",
              "105  World Business Briefing | Americas: Brazil: Jo...  The New York Times   \n",
              "106  World Business Briefing | Asia: Malaysia: Indu...  The New York Times   \n",
              "107  World Business Briefing | Europe: Brazil: Indu...  The New York Times   \n",
              "108  DataBank; A Rate Increase Looms, and Stocks De...  The New York Times   \n",
              "109                            Industrial Output Rises  The New York Times   \n",
              "\n",
              "    language                                           raw_text  \\\n",
              "0         en  BUSINESS DIGEST 30-Year Bond Yield Rises As St...   \n",
              "1         en  Mortgage Costs Could Ambush the U.S. Economy C...   \n",
              "2         en  Despite Upturn in Rates, Dow Still Gains 95.62...   \n",
              "3         en  After a Month's Lull, Employers Report Strong ...   \n",
              "4         en  Traders Bet Fed Is Done With Rate Increases Tr...   \n",
              "..       ...                                                ...   \n",
              "105       en  World Business Briefing | Americas: Brazil: Jo...   \n",
              "106       en  World Business Briefing | Asia: Malaysia: Indu...   \n",
              "107       en  World Business Briefing | Europe: Brazil: Indu...   \n",
              "108       en  DataBank; A Rate Increase Looms, and Stocks De...   \n",
              "109       en  Industrial Output Rises Production at factorie...   \n",
              "\n",
              "                                               web_url  section_name  \\\n",
              "0    https://www.nytimes.com/1999/02/06/business/bu...  Business Day   \n",
              "1    https://www.nytimes.com/1999/04/02/business/mo...  Business Day   \n",
              "2    https://www.nytimes.com/1999/07/02/business/th...  Business Day   \n",
              "3    https://www.nytimes.com/1999/07/03/business/af...  Business Day   \n",
              "4    https://www.nytimes.com/1999/08/26/business/th...  Business Day   \n",
              "..                                                 ...           ...   \n",
              "105  https://www.nytimes.com/2004/09/24/business/wo...  Business Day   \n",
              "106  https://www.nytimes.com/2004/11/09/business/wo...  Business Day   \n",
              "107  https://www.nytimes.com/2004/11/11/business/wo...  Business Day   \n",
              "108  https://www.nytimes.com/2004/12/12/business/da...  Business Day   \n",
              "109  https://www.nytimes.com/2004/12/15/business/in...  Business Day   \n",
              "\n",
              "                   news_desk  \n",
              "0    Business/Financial Desk  \n",
              "1    Business/Financial Desk  \n",
              "2    Business/Financial Desk  \n",
              "3    Business/Financial Desk  \n",
              "4    Business/Financial Desk  \n",
              "..                       ...  \n",
              "105  Business/Financial Desk  \n",
              "106  Business/Financial Desk  \n",
              "107  Business/Financial Desk  \n",
              "108           SundayBusiness  \n",
              "109  Business/Financial Desk  \n",
              "\n",
              "[110 rows x 10 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-13b4a7c9-d0d0-48bc-b074-49535b63335b\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_1999-02-06_1267</td>\n",
              "      <td>news</td>\n",
              "      <td>1999-02-06</td>\n",
              "      <td>BUSINESS DIGEST</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>BUSINESS DIGEST 30-Year Bond Yield Rises As St...</td>\n",
              "      <td>https://www.nytimes.com/1999/02/06/business/bu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_1999-04-02_0383</td>\n",
              "      <td>news</td>\n",
              "      <td>1999-04-02</td>\n",
              "      <td>Mortgage Costs Could Ambush the U.S. Economy</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Mortgage Costs Could Ambush the U.S. Economy C...</td>\n",
              "      <td>https://www.nytimes.com/1999/04/02/business/mo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_1999-07-02_0499</td>\n",
              "      <td>news</td>\n",
              "      <td>1999-07-02</td>\n",
              "      <td>Despite Upturn in Rates, Dow Still Gains 95.62...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Despite Upturn in Rates, Dow Still Gains 95.62...</td>\n",
              "      <td>https://www.nytimes.com/1999/07/02/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_1999-07-03_0702</td>\n",
              "      <td>news</td>\n",
              "      <td>1999-07-03</td>\n",
              "      <td>After a Month's Lull, Employers Report Strong ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>After a Month's Lull, Employers Report Strong ...</td>\n",
              "      <td>https://www.nytimes.com/1999/07/03/business/af...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_1999-08-26_6459</td>\n",
              "      <td>news</td>\n",
              "      <td>1999-08-26</td>\n",
              "      <td>Traders Bet Fed Is Done With Rate Increases</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Traders Bet Fed Is Done With Rate Increases Tr...</td>\n",
              "      <td>https://www.nytimes.com/1999/08/26/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>105</th>\n",
              "      <td>NEWS_2004-09-24_7172</td>\n",
              "      <td>news</td>\n",
              "      <td>2004-09-24</td>\n",
              "      <td>World Business Briefing | Americas: Brazil: Jo...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Americas: Brazil: Jo...</td>\n",
              "      <td>https://www.nytimes.com/2004/09/24/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>106</th>\n",
              "      <td>NEWS_2004-11-09_2710</td>\n",
              "      <td>news</td>\n",
              "      <td>2004-11-09</td>\n",
              "      <td>World Business Briefing | Asia: Malaysia: Indu...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Asia: Malaysia: Indu...</td>\n",
              "      <td>https://www.nytimes.com/2004/11/09/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>107</th>\n",
              "      <td>NEWS_2004-11-11_3112</td>\n",
              "      <td>news</td>\n",
              "      <td>2004-11-11</td>\n",
              "      <td>World Business Briefing | Europe: Brazil: Indu...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Europe: Brazil: Indu...</td>\n",
              "      <td>https://www.nytimes.com/2004/11/11/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>108</th>\n",
              "      <td>NEWS_2004-12-12_3398</td>\n",
              "      <td>news</td>\n",
              "      <td>2004-12-12</td>\n",
              "      <td>DataBank; A Rate Increase Looms, and Stocks De...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>DataBank; A Rate Increase Looms, and Stocks De...</td>\n",
              "      <td>https://www.nytimes.com/2004/12/12/business/da...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>SundayBusiness</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>109</th>\n",
              "      <td>NEWS_2004-12-15_4658</td>\n",
              "      <td>news</td>\n",
              "      <td>2004-12-15</td>\n",
              "      <td>Industrial Output Rises</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Industrial Output Rises Production at factorie...</td>\n",
              "      <td>https://www.nytimes.com/2004/12/15/business/in...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>110 rows √ó 10 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-13b4a7c9-d0d0-48bc-b074-49535b63335b')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-13b4a7c9-d0d0-48bc-b074-49535b63335b button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-13b4a7c9-d0d0-48bc-b074-49535b63335b');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-0ed147f3-427a-4522-87ba-118752b00fe3\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0ed147f3-427a-4522-87ba-118752b00fe3')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-0ed147f3-427a-4522-87ba-118752b00fe3 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"run_nyt_archive_chunk(1999, 2004)\",\n  \"rows\": 110,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 110,\n        \"samples\": [\n          \"NEWS_2003-08-10_2362\",\n          \"NEWS_2000-02-05_1228\",\n          \"NEWS_1999-08-26_6459\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 84,\n        \"samples\": [\n          \"2004-06-30\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 103,\n        \"samples\": [\n          \"FED LOWERS RATES BY QUARTER-POINT IN 6TH CUT OF YEAR\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 110,\n        \"samples\": [\n          \"Survival Tips For a World Of Low Rates Here are some ways to help yourself in a world of low interest rates: Options for investors seeking to survive in world of low interest rates include Treasury Department's inflation-indexed bonds and indexed mutual funds (S) Options for investors seeking to survive in world of low interest rates include Treasury Department's inflation-indexed bonds and indexed mutual funds (S)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 110,\n        \"samples\": [\n          \"https://www.nytimes.com/2003/08/10/business/survival-tips-for-a-world-of-low-rates.html\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"U.S.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 10,\n        \"samples\": [\n          \"Business / World Business\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 12
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "run_nyt_archive_chunk(2005, 2010)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "fwmYKhENIih_",
        "outputId": "773a9953-ea6f-4bec-f4a3-b6c9b53cb54a"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "==============================\n",
            " NYT ARCHIVE CHUNK: 2005 ~ 2010\n",
            "==============================\n",
            "\n",
            "=== YEAR 2005 ===\n",
            " Fetching 2005-01 ...\n",
            "  docs: 10567\n",
            " Fetching 2005-02 ...\n",
            "  docs: 9311\n",
            " Fetching 2005-03 ...\n",
            "  docs: 10262\n",
            " Fetching 2005-04 ...\n",
            "  docs: 10180\n",
            " Fetching 2005-05 ...\n",
            "  docs: 10526\n",
            " Fetching 2005-06 ...\n",
            "  docs: 10032\n",
            " Fetching 2005-07 ...\n",
            "  docs: 10113\n",
            " Fetching 2005-08 ...\n",
            "  docs: 9698\n",
            " Fetching 2005-09 ...\n",
            "  docs: 10256\n",
            " Fetching 2005-10 ...\n",
            "  docs: 10464\n",
            " Fetching 2005-11 ...\n",
            "  docs: 10130\n",
            " Fetching 2005-12 ...\n",
            "  docs: 9946\n",
            "[SAVE] nyt_raw_partial_2005_2005.csv ‚Üí 16 rows\n",
            "=== YEAR 2006 ===\n",
            " Fetching 2006-01 ...\n",
            "  docs: 10671\n",
            " Fetching 2006-02 ...\n",
            "  docs: 10030\n",
            " Fetching 2006-03 ...\n",
            "  docs: 12357\n",
            " Fetching 2006-04 ...\n",
            "  docs: 12130\n",
            " Fetching 2006-05 ...\n",
            "  docs: 15001\n",
            " Fetching 2006-06 ...\n",
            "  docs: 15109\n",
            " Fetching 2006-07 ...\n",
            "  docs: 14294\n",
            " Fetching 2006-08 ...\n",
            "  docs: 14075\n",
            " Fetching 2006-09 ...\n",
            "  docs: 15036\n",
            " Fetching 2006-10 ...\n",
            "  docs: 14845\n",
            " Fetching 2006-11 ...\n",
            "  docs: 15028\n",
            " Fetching 2006-12 ...\n",
            "  docs: 14904\n",
            "[SAVE] nyt_raw_partial_2005_2006.csv ‚Üí 31 rows\n",
            "=== YEAR 2007 ===\n",
            " Fetching 2007-01 ...\n",
            "  docs: 7905\n",
            " Fetching 2007-02 ...\n",
            "  docs: 7186\n",
            " Fetching 2007-03 ...\n",
            "  docs: 8428\n",
            " Fetching 2007-04 ...\n",
            "  docs: 8068\n",
            " Fetching 2007-05 ...\n",
            "  docs: 8254\n",
            " Fetching 2007-06 ...\n",
            "  docs: 8230\n",
            " Fetching 2007-07 ...\n",
            "  docs: 8558\n",
            " Fetching 2007-08 ...\n",
            "  docs: 8061\n",
            " Fetching 2007-09 ...\n",
            "  docs: 9063\n",
            " Fetching 2007-10 ...\n",
            "  docs: 9561\n",
            " Fetching 2007-11 ...\n",
            "  docs: 8687\n",
            " Fetching 2007-12 ...\n",
            "  docs: 8962\n",
            "[SAVE] nyt_raw_partial_2005_2007.csv ‚Üí 36 rows\n",
            "=== YEAR 2008 ===\n",
            " Fetching 2008-01 ...\n",
            "  docs: 9857\n",
            " Fetching 2008-02 ...\n",
            "  docs: 9083\n",
            " Fetching 2008-03 ...\n",
            "  docs: 9561\n",
            " Fetching 2008-04 ...\n",
            "  docs: 9449\n",
            " Fetching 2008-05 ...\n",
            "  docs: 9468\n",
            " Fetching 2008-06 ...\n",
            "  docs: 9368\n",
            " Fetching 2008-07 ...\n",
            "  docs: 9323\n",
            " Fetching 2008-08 ...\n",
            "  docs: 10281\n",
            " Fetching 2008-09 ...\n",
            "  docs: 10769\n",
            " Fetching 2008-10 ...\n",
            "  docs: 11545\n",
            " Fetching 2008-11 ...\n",
            "  docs: 10054\n",
            " Fetching 2008-12 ...\n",
            "  docs: 10137\n",
            "[SAVE] nyt_raw_partial_2005_2008.csv ‚Üí 38 rows\n",
            "=== YEAR 2009 ===\n",
            " Fetching 2009-01 ...\n",
            "  docs: 10691\n",
            " Fetching 2009-02 ...\n",
            "  docs: 10072\n",
            " Fetching 2009-03 ...\n",
            "  docs: 11334\n",
            " Fetching 2009-04 ...\n",
            "  docs: 11042\n",
            " Fetching 2009-05 ...\n",
            "  docs: 13632\n",
            " Fetching 2009-06 ...\n",
            "  docs: 14413\n",
            " Fetching 2009-07 ...\n",
            "  docs: 13687\n",
            " Fetching 2009-08 ...\n",
            "  docs: 13140\n",
            " Fetching 2009-09 ...\n",
            "  docs: 14558\n",
            " Fetching 2009-10 ...\n",
            "  docs: 15463\n",
            " Fetching 2009-11 ...\n",
            "  docs: 9432\n",
            " Fetching 2009-12 ...\n",
            "  docs: 9475\n",
            "[SAVE] nyt_raw_partial_2005_2009.csv ‚Üí 45 rows\n",
            "=== YEAR 2010 ===\n",
            " Fetching 2010-01 ...\n",
            "  docs: 9820\n",
            " Fetching 2010-02 ...\n",
            "  docs: 9298\n",
            " Fetching 2010-03 ...\n",
            "  docs: 10452\n",
            " Fetching 2010-04 ...\n",
            "  docs: 9770\n",
            " Fetching 2010-05 ...\n",
            "  docs: 9537\n",
            " Fetching 2010-06 ...\n",
            "  docs: 9609\n",
            " Fetching 2010-07 ...\n",
            "  docs: 9085\n",
            " Fetching 2010-08 ...\n",
            "  docs: 8793\n",
            " Fetching 2010-09 ...\n",
            "  docs: 9404\n",
            " Fetching 2010-10 ...\n",
            "  docs: 9691\n",
            " Fetching 2010-11 ...\n",
            "  docs: 8679\n",
            " Fetching 2010-12 ...\n",
            "  docs: 8310\n",
            "[SAVE] nyt_raw_partial_2005_2010.csv ‚Üí 54 rows\n",
            "\n",
            "[FINISHED] Saved ‚Üí nyt_raw_2005_2010.csv (54 rows)\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                   doc_id doc_type        date  \\\n",
              "0   NEWS_2005-01-30_10311     news  2005-01-30   \n",
              "1    NEWS_2005-02-01_0204     news  2005-02-01   \n",
              "2    NEWS_2005-02-03_0747     news  2005-02-03   \n",
              "3    NEWS_2005-02-03_1037     news  2005-02-03   \n",
              "4    NEWS_2005-03-23_7416     news  2005-03-23   \n",
              "5    NEWS_2005-05-04_1125     news  2005-05-04   \n",
              "6    NEWS_2005-05-06_1894     news  2005-05-06   \n",
              "7    NEWS_2005-06-27_9020     news  2005-06-27   \n",
              "8    NEWS_2005-06-30_9855     news  2005-06-30   \n",
              "9    NEWS_2005-07-01_0025     news  2005-07-01   \n",
              "10  NEWS_2005-10-31_10324     news  2005-10-31   \n",
              "11   NEWS_2005-11-01_0341     news  2005-11-01   \n",
              "12   NEWS_2005-11-03_0923     news  2005-11-03   \n",
              "13   NEWS_2005-12-13_4533     news  2005-12-13   \n",
              "14   NEWS_2005-12-14_4680     news  2005-12-14   \n",
              "15   NEWS_2005-12-16_5238     news  2005-12-16   \n",
              "16  NEWS_2006-01-31_10609     news  2006-01-31   \n",
              "17   NEWS_2006-05-11_4875     news  2006-05-11   \n",
              "18   NEWS_2006-05-11_4962     news  2006-05-11   \n",
              "19   NEWS_2006-05-11_5150     news  2006-05-11   \n",
              "20  NEWS_2006-06-29_14464     news  2006-06-29   \n",
              "21   NEWS_2006-08-05_1848     news  2006-08-05   \n",
              "22   NEWS_2006-08-09_3922     news  2006-08-09   \n",
              "23   NEWS_2006-08-10_4225     news  2006-08-10   \n",
              "24   NEWS_2006-09-18_8866     news  2006-09-18   \n",
              "25   NEWS_2006-09-18_8960     news  2006-09-18   \n",
              "26   NEWS_2006-09-19_9502     news  2006-09-19   \n",
              "27  NEWS_2006-10-24_11089     news  2006-10-24   \n",
              "28   NEWS_2006-12-13_6324     news  2006-12-13   \n",
              "29   NEWS_2006-12-13_6663     news  2006-12-13   \n",
              "30   NEWS_2006-12-15_7348     news  2006-12-15   \n",
              "31   NEWS_2007-01-31_7872     news  2007-01-31   \n",
              "32   NEWS_2007-03-22_5960     news  2007-03-22   \n",
              "33   NEWS_2007-06-28_7590     news  2007-06-28   \n",
              "34   NEWS_2007-08-10_2574     news  2007-08-10   \n",
              "35   NEWS_2007-09-20_5686     news  2007-09-20   \n",
              "36   NEWS_2008-10-11_3849     news  2008-10-11   \n",
              "37   NEWS_2008-10-27_9542     news  2008-10-27   \n",
              "38   NEWS_2009-03-16_5361     news  2009-03-16   \n",
              "39   NEWS_2009-03-16_5382     news  2009-03-16   \n",
              "40   NEWS_2009-03-17_5921     news  2009-03-17   \n",
              "41   NEWS_2009-03-20_7241     news  2009-03-20   \n",
              "42   NEWS_2009-08-13_5043     news  2009-08-13   \n",
              "43   NEWS_2009-11-05_1453     news  2009-11-05   \n",
              "44   NEWS_2009-11-06_2104     news  2009-11-06   \n",
              "45   NEWS_2010-03-19_6554     news  2010-03-19   \n",
              "46   NEWS_2010-04-27_8403     news  2010-04-27   \n",
              "47   NEWS_2010-06-22_6819     news  2010-06-22   \n",
              "48   NEWS_2010-08-10_2583     news  2010-08-10   \n",
              "49   NEWS_2010-08-11_2838     news  2010-08-11   \n",
              "50   NEWS_2010-09-21_6351     news  2010-09-21   \n",
              "51   NEWS_2010-09-22_6539     news  2010-09-22   \n",
              "52   NEWS_2010-09-24_7326     news  2010-09-24   \n",
              "53   NEWS_2010-12-17_4969     news  2010-12-17   \n",
              "\n",
              "                                                title              source  \\\n",
              "0          Markets Manage to End a 2005 Losing Streak  The New York Times   \n",
              "1   Shares Rise After Iraqi Election, but End Down...  The New York Times   \n",
              "2    Nominee Says U.S. Agents Abused Power After 9/11  The New York Times   \n",
              "3    German Joblessness Rises as Benefits Are Reduced  The New York Times   \n",
              "4   Fed Lifts Rate 7th Time in Year and Warns of G...  The New York Times   \n",
              "5               Fed Raises Rates but Bobbles Delivery  The New York Times   \n",
              "6          Fed Chief Says 'Forces' Keep Inflation Low  The New York Times   \n",
              "7             Low Rates Could Be Around for Long Term  The New York Times   \n",
              "8                                     BUSINESS DIGEST  The New York Times   \n",
              "9   Shares Finish Slow Quarter, as Oil and Bonds M...  The New York Times   \n",
              "10                                      LOOKING AHEAD  The New York Times   \n",
              "11    Shares Rally for 2nd Day as Oil Drops Below $60  The New York Times   \n",
              "12  World Business Briefing | Europe: Germany: Une...  The New York Times   \n",
              "13  World Business Briefing | Asia: India: Industr...  The New York Times   \n",
              "14                     Text of Fed Statement on Rates  The New York Times   \n",
              "15                Price Index Shows Big November Drop  The New York Times   \n",
              "16  Hebron Settlers vs. an Unlikely Foe: Israel's ...  The New York Times   \n",
              "17                  The Start-Up as the First Step Up  The New York Times   \n",
              "18                                  TODAY IN BUSINESS  The New York Times   \n",
              "19                  The Start-Up as the First Step Up  The New York Times   \n",
              "20                                  TODAY IN BUSINESS  The New York Times   \n",
              "21                    Job Growth Slackened Last Month  The New York Times   \n",
              "22         Shares Fall as Investors Doubt Fed Is Done  The New York Times   \n",
              "23          Indexes Off Again Despite Strong Earnings  The New York Times   \n",
              "24                                      Looking Ahead  The New York Times   \n",
              "25                                      Looking Ahead  The New York Times   \n",
              "26  Inflation Fears and Rising Oil Prices Bring Ra...  The New York Times   \n",
              "27     Russia‚Äôs ‚ÄòSecond Party‚Äô Scores Significant Win  The New York Times   \n",
              "28                India: Industrial Output Pace Slows  The New York Times   \n",
              "29  World Business Briefing | Asia: India: Industr...  The New York Times   \n",
              "30                                  TODAY IN BUSINESS  The New York Times   \n",
              "31          How Jobless Rates Forecast the Super Bowl  The New York Times   \n",
              "32  The Global Deterioration Scale for Assessment ...  The New York Times   \n",
              "33        Japan: Industrial Production Dropped in May  The New York Times   \n",
              "34     New Zealand‚Äôs Jobless Rate Falls to Record Low  The New York Times   \n",
              "35                        Not What the Doctor Ordered  The New York Times   \n",
              "36       One Thing You Can Control: Your Credit Score  The New York Times   \n",
              "37                 So When Will the Banks Give Loans?  The New York Times   \n",
              "38                                      Looking Ahead  The New York Times   \n",
              "39  A.I.G. Lists Banks It Paid With U.S. Bailout F...  The New York Times   \n",
              "40           Economic Data Offers a Balm as Fed Meets  The New York Times   \n",
              "41              Mexico: Son of Cartel Leader Detained  The New York Times   \n",
              "42             23 Filipino Soldiers Killed in Clashes  The New York Times   \n",
              "43  Reports Show Conflicting Number of Jobs Attrib...  The New York Times   \n",
              "44            Explaining the Big Jump in Unemployment  The New York Times   \n",
              "45                    When Not to Pay Down a Mortgage  The New York Times   \n",
              "46           How to Lower the Burden of Student Loans  The New York Times   \n",
              "47         Find an Angel Investor Before You Need One  The New York Times   \n",
              "48  10-Year Treasury Yields Slide on Fed‚Äôs Decisio...  The New York Times   \n",
              "49    10-Year Treasury Yields Slide on Fed‚Äôs Decision  The New York Times   \n",
              "50  Fed Stands Pat and Says It Is Still Ready to B...  The New York Times   \n",
              "51  Fed Stands Pat and Says It Is Still Ready to B...  The New York Times   \n",
              "52   Banks Sitting Out Bond Surge as Lending Dries Up  The New York Times   \n",
              "53               Keeping the Good News in Perspective  The New York Times   \n",
              "\n",
              "   language                                           raw_text  \\\n",
              "0        en  Markets Manage to End a 2005 Losing Streak On ...   \n",
              "1        en  Shares Rise After Iraqi Election, but End Down...   \n",
              "2        en  Nominee Says U.S. Agents Abused Power After 9/...   \n",
              "3        en  German Joblessness Rises as Benefits Are Reduc...   \n",
              "4        en  Fed Lifts Rate 7th Time in Year and Warns of G...   \n",
              "5        en  Fed Raises Rates but Bobbles Delivery WASHINGT...   \n",
              "6        en  Fed Chief Says 'Forces' Keep Inflation Low A r...   \n",
              "7        en  Low Rates Could Be Around for Long Term WASHIN...   \n",
              "8        en  BUSINESS DIGEST Morgan Stanley Directors Expec...   \n",
              "9        en  Shares Finish Slow Quarter, as Oil and Bonds M...   \n",
              "10       en  LOOKING AHEAD IN STORE -- Retailers have alrea...   \n",
              "11       en  Shares Rally for 2nd Day as Oil Drops Below $6...   \n",
              "12       en  World Business Briefing | Europe: Germany: Une...   \n",
              "13       en  World Business Briefing | Asia: India: Industr...   \n",
              "14       en  Text of Fed Statement on Rates Following is th...   \n",
              "15       en  Price Index Shows Big November Drop The nation...   \n",
              "16       en  Hebron Settlers vs. an Unlikely Foe: Israel's ...   \n",
              "17       en  The Start-Up as the First Step Up At age 7, Ja...   \n",
              "18       en  TODAY IN BUSINESS U.S. AND THE YUAN The Bush a...   \n",
              "19       en  The Start-Up as the First Step Up At age 7, Ja...   \n",
              "20       en  TODAY IN BUSINESS GOOGLE PAYMENT SERVICE Googl...   \n",
              "21       en  Job Growth Slackened Last Month Employers adde...   \n",
              "22       en  Shares Fall as Investors Doubt Fed Is Done Sto...   \n",
              "23       en  Indexes Off Again Despite Strong Earnings Stoc...   \n",
              "24       en  Looking Ahead EYES ON THE FED The main news of...   \n",
              "25       en  Looking Ahead EYES ON THE FED -- The main news...   \n",
              "26       en  Inflation Fears and Rising Oil Prices Bring Ra...   \n",
              "27       en  Russia‚Äôs ‚ÄòSecond Party‚Äô Scores Significant Win...   \n",
              "28       en  India: Industrial Output Pace Slows India‚Äôs in...   \n",
              "29       en  World Business Briefing | Asia: India: Industr...   \n",
              "30       en  TODAY IN BUSINESS INQUIRIES AT INTERIOR DEPT. ...   \n",
              "31       en  How Jobless Rates Forecast the Super Bowl At l...   \n",
              "32       en  The Global Deterioration Scale for Assessment ...   \n",
              "33       en  Japan: Industrial Production Dropped in May Ja...   \n",
              "34       en  New Zealand‚Äôs Jobless Rate Falls to Record Low...   \n",
              "35       en  Not What the Doctor Ordered Now that the Feder...   \n",
              "36       en  One Thing You Can Control: Your Credit Score I...   \n",
              "37       en  So When Will the Banks Give Loans? The dirty l...   \n",
              "38       en  Looking Ahead ECONOMIC DATA Reports will inclu...   \n",
              "39       en  A.I.G. Lists Banks It Paid With U.S. Bailout F...   \n",
              "40       en  Economic Data Offers a Balm as Fed Meets An un...   \n",
              "41       en  Mexico: Son of Cartel Leader Detained Soldiers...   \n",
              "42       en  23 Filipino Soldiers Killed in Clashes MANILA ...   \n",
              "43       en  Reports Show Conflicting Number of Jobs Attrib...   \n",
              "44       en  Explaining the Big Jump in Unemployment The un...   \n",
              "45       en  When Not to Pay Down a Mortgage This week, the...   \n",
              "46       en  How to Lower the Burden of Student Loans Presi...   \n",
              "47       en  Find an Angel Investor Before You Need One Tin...   \n",
              "48       en  10-Year Treasury Yields Slide on Fed‚Äôs Decisio...   \n",
              "49       en  10-Year Treasury Yields Slide on Fed‚Äôs Decisio...   \n",
              "50       en  Fed Stands Pat and Says It Is Still Ready to B...   \n",
              "51       en  Fed Stands Pat and Says It Is Still Ready to B...   \n",
              "52       en  Banks Sitting Out Bond Surge as Lending Dries ...   \n",
              "53       en  Keeping the Good News in Perspective The most ...   \n",
              "\n",
              "                                              web_url  section_name  \\\n",
              "0   https://www.nytimes.com/2005/01/30/business/yo...  Business Day   \n",
              "1   https://www.nytimes.com/2005/02/01/business/sh...  Business Day   \n",
              "2   https://www.nytimes.com/2005/02/03/politics/no...          U.S.   \n",
              "3   https://www.nytimes.com/2005/02/03/business/wo...  Business Day   \n",
              "4   https://www.nytimes.com/2005/03/23/business/fe...  Business Day   \n",
              "5   https://www.nytimes.com/2005/05/04/business/fe...  Business Day   \n",
              "6   https://www.nytimes.com/2005/05/06/business/fe...  Business Day   \n",
              "7   https://www.nytimes.com/2005/06/27/business/lo...  Business Day   \n",
              "8   https://www.nytimes.com/2005/06/30/business/bu...  Business Day   \n",
              "9   https://www.nytimes.com/2005/07/01/business/sh...  Business Day   \n",
              "10  https://www.nytimes.com/2005/10/31/business/lo...  Business Day   \n",
              "11  https://www.nytimes.com/2005/11/01/business/sh...  Business Day   \n",
              "12  https://www.nytimes.com/2005/11/03/business/wo...  Business Day   \n",
              "13  https://www.nytimes.com/2005/12/13/business/wo...  Business Day   \n",
              "14  https://www.nytimes.com/2005/12/14/business/te...  Business Day   \n",
              "15  https://www.nytimes.com/2005/12/16/business/pr...  Business Day   \n",
              "16  https://www.nytimes.com/2006/01/31/world/middl...         World   \n",
              "17  https://www.nytimes.com/2006/05/11/business/11...  Business Day   \n",
              "18  https://www.nytimes.com/2006/05/11/business/to...  Business Day   \n",
              "19  https://www.nytimes.com/2006/05/11/business/th...  Business Day   \n",
              "20  https://www.nytimes.com/2006/06/29/business/to...  Business Day   \n",
              "21  https://www.nytimes.com/2006/08/05/business/jo...  Business Day   \n",
              "22  https://www.nytimes.com/2006/08/09/business/sh...  Business Day   \n",
              "23  https://www.nytimes.com/2006/08/10/business/in...  Business Day   \n",
              "24  https://www.nytimes.com/2006/09/18/business/18...  Business Day   \n",
              "25  https://www.nytimes.com/2006/09/18/business/lo...  Business Day   \n",
              "26  https://www.nytimes.com/2006/09/19/business/in...  Business Day   \n",
              "27  https://www.nytimes.com/2006/10/24/world/europ...         World   \n",
              "28  https://www.nytimes.com/2006/12/13/business/wo...  Business Day   \n",
              "29  https://www.nytimes.com/2006/12/13/business/wo...  Business Day   \n",
              "30  https://www.nytimes.com/2006/12/15/business/to...  Business Day   \n",
              "31  https://economix.blogs.nytimes.com/2007/01/31/...  Business Day   \n",
              "32  https://www.nytimes.com/2007/03/22/us/25_alz_t...          U.S.   \n",
              "33  https://www.nytimes.com/2007/06/28/business/wo...  Business Day   \n",
              "34  https://www.nytimes.com/2007/08/10/business/wo...  Business Day   \n",
              "35  https://economix.blogs.nytimes.com/2007/09/20/...  Business Day   \n",
              "36  https://www.nytimes.com/2008/10/11/business/yo...  Business Day   \n",
              "37  https://dealbook.nytimes.com/2008/10/27/so-whe...  Business Day   \n",
              "38  https://www.nytimes.com/2009/03/16/business/16...  Business Day   \n",
              "39  https://www.nytimes.com/2009/03/16/business/16...  Business Day   \n",
              "40  https://www.nytimes.com/2009/03/18/business/ec...  Business Day   \n",
              "41  https://www.nytimes.com/2009/03/20/world/ameri...         World   \n",
              "42  https://www.nytimes.com/2009/08/14/world/asia/...         World   \n",
              "43  https://www.nytimes.com/2009/11/05/us/05stimul...          U.S.   \n",
              "44  https://economix.blogs.nytimes.com/2009/11/06/...  Business Day   \n",
              "45  https://www.nytimes.com/2010/03/20/your-money/...    Your Money   \n",
              "46  https://bucks.blogs.nytimes.com/2010/04/27/how...    Your Money   \n",
              "47  https://boss.blogs.nytimes.com/2010/06/22/find...  Business Day   \n",
              "48  https://www.nytimes.com/2010/08/11/business/11...  Business Day   \n",
              "49  https://dealbook.nytimes.com/2010/08/11/10-yea...  Business Day   \n",
              "50  https://www.nytimes.com/2010/09/22/business/ec...  Business Day   \n",
              "51  https://dealbook.nytimes.com/2010/09/22/fed-st...  Business Day   \n",
              "52  https://dealbook.nytimes.com/2010/09/24/banks-...  Business Day   \n",
              "53  https://economix.blogs.nytimes.com/2010/12/17/...  Business Day   \n",
              "\n",
              "                  news_desk  \n",
              "0            SundayBusiness  \n",
              "1   Business/Financial Desk  \n",
              "2             National Desk  \n",
              "3   Business/Financial Desk  \n",
              "4   Business/Financial Desk  \n",
              "5   Business/Financial Desk  \n",
              "6   Business/Financial Desk  \n",
              "7   Business/Financial Desk  \n",
              "8   Business/Financial Desk  \n",
              "9   Business/Financial Desk  \n",
              "10  Business/Financial Desk  \n",
              "11  Business/Financial Desk  \n",
              "12  Business/Financial Desk  \n",
              "13  Business/Financial Desk  \n",
              "14  Business/Financial Desk  \n",
              "15  Business/Financial Desk  \n",
              "16             Foreign Desk  \n",
              "17                 Business  \n",
              "18  Business/Financial Desk  \n",
              "19  Business/Financial Desk  \n",
              "20  Business/Financial Desk  \n",
              "21  Business/Financial Desk  \n",
              "22  Business/Financial Desk  \n",
              "23  Business/Financial Desk  \n",
              "24                 Business  \n",
              "25  Business/Financial Desk  \n",
              "26  Business/Financial Desk  \n",
              "27             Foreign Desk  \n",
              "28                 Business  \n",
              "29  Business/Financial Desk  \n",
              "30  Business/Financial Desk  \n",
              "31                 Business  \n",
              "32                      WEB  \n",
              "33                 Business  \n",
              "34                 Business  \n",
              "35                 Business  \n",
              "36                 Business  \n",
              "37                 Business  \n",
              "38                 Business  \n",
              "39                 Business  \n",
              "40                 Business  \n",
              "41                  Foreign  \n",
              "42                  Foreign  \n",
              "43                 National  \n",
              "44                 Business  \n",
              "45                 Business  \n",
              "46                           \n",
              "47                 Business  \n",
              "48                 Business  \n",
              "49                 Business  \n",
              "50                 Business  \n",
              "51                 Business  \n",
              "52                 Business  \n",
              "53                           "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-7f2c332d-013f-4845-a64d-b49190008a1b\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_2005-01-30_10311</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-01-30</td>\n",
              "      <td>Markets Manage to End a 2005 Losing Streak</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Markets Manage to End a 2005 Losing Streak On ...</td>\n",
              "      <td>https://www.nytimes.com/2005/01/30/business/yo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>SundayBusiness</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_2005-02-01_0204</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-02-01</td>\n",
              "      <td>Shares Rise After Iraqi Election, but End Down...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Shares Rise After Iraqi Election, but End Down...</td>\n",
              "      <td>https://www.nytimes.com/2005/02/01/business/sh...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_2005-02-03_0747</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-02-03</td>\n",
              "      <td>Nominee Says U.S. Agents Abused Power After 9/11</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Nominee Says U.S. Agents Abused Power After 9/...</td>\n",
              "      <td>https://www.nytimes.com/2005/02/03/politics/no...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_2005-02-03_1037</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-02-03</td>\n",
              "      <td>German Joblessness Rises as Benefits Are Reduced</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>German Joblessness Rises as Benefits Are Reduc...</td>\n",
              "      <td>https://www.nytimes.com/2005/02/03/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_2005-03-23_7416</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-03-23</td>\n",
              "      <td>Fed Lifts Rate 7th Time in Year and Warns of G...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Lifts Rate 7th Time in Year and Warns of G...</td>\n",
              "      <td>https://www.nytimes.com/2005/03/23/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>NEWS_2005-05-04_1125</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-05-04</td>\n",
              "      <td>Fed Raises Rates but Bobbles Delivery</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Raises Rates but Bobbles Delivery WASHINGT...</td>\n",
              "      <td>https://www.nytimes.com/2005/05/04/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6</th>\n",
              "      <td>NEWS_2005-05-06_1894</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-05-06</td>\n",
              "      <td>Fed Chief Says 'Forces' Keep Inflation Low</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Chief Says 'Forces' Keep Inflation Low A r...</td>\n",
              "      <td>https://www.nytimes.com/2005/05/06/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>7</th>\n",
              "      <td>NEWS_2005-06-27_9020</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-06-27</td>\n",
              "      <td>Low Rates Could Be Around for Long Term</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Low Rates Could Be Around for Long Term WASHIN...</td>\n",
              "      <td>https://www.nytimes.com/2005/06/27/business/lo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>8</th>\n",
              "      <td>NEWS_2005-06-30_9855</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-06-30</td>\n",
              "      <td>BUSINESS DIGEST</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>BUSINESS DIGEST Morgan Stanley Directors Expec...</td>\n",
              "      <td>https://www.nytimes.com/2005/06/30/business/bu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9</th>\n",
              "      <td>NEWS_2005-07-01_0025</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-07-01</td>\n",
              "      <td>Shares Finish Slow Quarter, as Oil and Bonds M...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Shares Finish Slow Quarter, as Oil and Bonds M...</td>\n",
              "      <td>https://www.nytimes.com/2005/07/01/business/sh...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10</th>\n",
              "      <td>NEWS_2005-10-31_10324</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-10-31</td>\n",
              "      <td>LOOKING AHEAD</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>LOOKING AHEAD IN STORE -- Retailers have alrea...</td>\n",
              "      <td>https://www.nytimes.com/2005/10/31/business/lo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>11</th>\n",
              "      <td>NEWS_2005-11-01_0341</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-11-01</td>\n",
              "      <td>Shares Rally for 2nd Day as Oil Drops Below $60</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Shares Rally for 2nd Day as Oil Drops Below $6...</td>\n",
              "      <td>https://www.nytimes.com/2005/11/01/business/sh...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>12</th>\n",
              "      <td>NEWS_2005-11-03_0923</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-11-03</td>\n",
              "      <td>World Business Briefing | Europe: Germany: Une...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Europe: Germany: Une...</td>\n",
              "      <td>https://www.nytimes.com/2005/11/03/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>13</th>\n",
              "      <td>NEWS_2005-12-13_4533</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-12-13</td>\n",
              "      <td>World Business Briefing | Asia: India: Industr...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Asia: India: Industr...</td>\n",
              "      <td>https://www.nytimes.com/2005/12/13/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>14</th>\n",
              "      <td>NEWS_2005-12-14_4680</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-12-14</td>\n",
              "      <td>Text of Fed Statement on Rates</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Text of Fed Statement on Rates Following is th...</td>\n",
              "      <td>https://www.nytimes.com/2005/12/14/business/te...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>15</th>\n",
              "      <td>NEWS_2005-12-16_5238</td>\n",
              "      <td>news</td>\n",
              "      <td>2005-12-16</td>\n",
              "      <td>Price Index Shows Big November Drop</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Price Index Shows Big November Drop The nation...</td>\n",
              "      <td>https://www.nytimes.com/2005/12/16/business/pr...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>16</th>\n",
              "      <td>NEWS_2006-01-31_10609</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-01-31</td>\n",
              "      <td>Hebron Settlers vs. an Unlikely Foe: Israel's ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Hebron Settlers vs. an Unlikely Foe: Israel's ...</td>\n",
              "      <td>https://www.nytimes.com/2006/01/31/world/middl...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>17</th>\n",
              "      <td>NEWS_2006-05-11_4875</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-05-11</td>\n",
              "      <td>The Start-Up as the First Step Up</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Start-Up as the First Step Up At age 7, Ja...</td>\n",
              "      <td>https://www.nytimes.com/2006/05/11/business/11...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>18</th>\n",
              "      <td>NEWS_2006-05-11_4962</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-05-11</td>\n",
              "      <td>TODAY IN BUSINESS</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>TODAY IN BUSINESS U.S. AND THE YUAN The Bush a...</td>\n",
              "      <td>https://www.nytimes.com/2006/05/11/business/to...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>19</th>\n",
              "      <td>NEWS_2006-05-11_5150</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-05-11</td>\n",
              "      <td>The Start-Up as the First Step Up</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Start-Up as the First Step Up At age 7, Ja...</td>\n",
              "      <td>https://www.nytimes.com/2006/05/11/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>20</th>\n",
              "      <td>NEWS_2006-06-29_14464</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-06-29</td>\n",
              "      <td>TODAY IN BUSINESS</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>TODAY IN BUSINESS GOOGLE PAYMENT SERVICE Googl...</td>\n",
              "      <td>https://www.nytimes.com/2006/06/29/business/to...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>21</th>\n",
              "      <td>NEWS_2006-08-05_1848</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-08-05</td>\n",
              "      <td>Job Growth Slackened Last Month</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Job Growth Slackened Last Month Employers adde...</td>\n",
              "      <td>https://www.nytimes.com/2006/08/05/business/jo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>22</th>\n",
              "      <td>NEWS_2006-08-09_3922</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-08-09</td>\n",
              "      <td>Shares Fall as Investors Doubt Fed Is Done</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Shares Fall as Investors Doubt Fed Is Done Sto...</td>\n",
              "      <td>https://www.nytimes.com/2006/08/09/business/sh...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>23</th>\n",
              "      <td>NEWS_2006-08-10_4225</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-08-10</td>\n",
              "      <td>Indexes Off Again Despite Strong Earnings</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Indexes Off Again Despite Strong Earnings Stoc...</td>\n",
              "      <td>https://www.nytimes.com/2006/08/10/business/in...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>24</th>\n",
              "      <td>NEWS_2006-09-18_8866</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-09-18</td>\n",
              "      <td>Looking Ahead</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Looking Ahead EYES ON THE FED The main news of...</td>\n",
              "      <td>https://www.nytimes.com/2006/09/18/business/18...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25</th>\n",
              "      <td>NEWS_2006-09-18_8960</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-09-18</td>\n",
              "      <td>Looking Ahead</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Looking Ahead EYES ON THE FED -- The main news...</td>\n",
              "      <td>https://www.nytimes.com/2006/09/18/business/lo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>26</th>\n",
              "      <td>NEWS_2006-09-19_9502</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-09-19</td>\n",
              "      <td>Inflation Fears and Rising Oil Prices Bring Ra...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Inflation Fears and Rising Oil Prices Bring Ra...</td>\n",
              "      <td>https://www.nytimes.com/2006/09/19/business/in...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>27</th>\n",
              "      <td>NEWS_2006-10-24_11089</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-10-24</td>\n",
              "      <td>Russia‚Äôs ‚ÄòSecond Party‚Äô Scores Significant Win</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Russia‚Äôs ‚ÄòSecond Party‚Äô Scores Significant Win...</td>\n",
              "      <td>https://www.nytimes.com/2006/10/24/world/europ...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>28</th>\n",
              "      <td>NEWS_2006-12-13_6324</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-12-13</td>\n",
              "      <td>India: Industrial Output Pace Slows</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>India: Industrial Output Pace Slows India‚Äôs in...</td>\n",
              "      <td>https://www.nytimes.com/2006/12/13/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29</th>\n",
              "      <td>NEWS_2006-12-13_6663</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-12-13</td>\n",
              "      <td>World Business Briefing | Asia: India: Industr...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>World Business Briefing | Asia: India: Industr...</td>\n",
              "      <td>https://www.nytimes.com/2006/12/13/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>30</th>\n",
              "      <td>NEWS_2006-12-15_7348</td>\n",
              "      <td>news</td>\n",
              "      <td>2006-12-15</td>\n",
              "      <td>TODAY IN BUSINESS</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>TODAY IN BUSINESS INQUIRIES AT INTERIOR DEPT. ...</td>\n",
              "      <td>https://www.nytimes.com/2006/12/15/business/to...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business/Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>31</th>\n",
              "      <td>NEWS_2007-01-31_7872</td>\n",
              "      <td>news</td>\n",
              "      <td>2007-01-31</td>\n",
              "      <td>How Jobless Rates Forecast the Super Bowl</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How Jobless Rates Forecast the Super Bowl At l...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2007/01/31/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>32</th>\n",
              "      <td>NEWS_2007-03-22_5960</td>\n",
              "      <td>news</td>\n",
              "      <td>2007-03-22</td>\n",
              "      <td>The Global Deterioration Scale for Assessment ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Global Deterioration Scale for Assessment ...</td>\n",
              "      <td>https://www.nytimes.com/2007/03/22/us/25_alz_t...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>WEB</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>33</th>\n",
              "      <td>NEWS_2007-06-28_7590</td>\n",
              "      <td>news</td>\n",
              "      <td>2007-06-28</td>\n",
              "      <td>Japan: Industrial Production Dropped in May</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Japan: Industrial Production Dropped in May Ja...</td>\n",
              "      <td>https://www.nytimes.com/2007/06/28/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>34</th>\n",
              "      <td>NEWS_2007-08-10_2574</td>\n",
              "      <td>news</td>\n",
              "      <td>2007-08-10</td>\n",
              "      <td>New Zealand‚Äôs Jobless Rate Falls to Record Low</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>New Zealand‚Äôs Jobless Rate Falls to Record Low...</td>\n",
              "      <td>https://www.nytimes.com/2007/08/10/business/wo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>35</th>\n",
              "      <td>NEWS_2007-09-20_5686</td>\n",
              "      <td>news</td>\n",
              "      <td>2007-09-20</td>\n",
              "      <td>Not What the Doctor Ordered</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Not What the Doctor Ordered Now that the Feder...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2007/09/20/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>36</th>\n",
              "      <td>NEWS_2008-10-11_3849</td>\n",
              "      <td>news</td>\n",
              "      <td>2008-10-11</td>\n",
              "      <td>One Thing You Can Control: Your Credit Score</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>One Thing You Can Control: Your Credit Score I...</td>\n",
              "      <td>https://www.nytimes.com/2008/10/11/business/yo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>37</th>\n",
              "      <td>NEWS_2008-10-27_9542</td>\n",
              "      <td>news</td>\n",
              "      <td>2008-10-27</td>\n",
              "      <td>So When Will the Banks Give Loans?</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>So When Will the Banks Give Loans? The dirty l...</td>\n",
              "      <td>https://dealbook.nytimes.com/2008/10/27/so-whe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>38</th>\n",
              "      <td>NEWS_2009-03-16_5361</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-03-16</td>\n",
              "      <td>Looking Ahead</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Looking Ahead ECONOMIC DATA Reports will inclu...</td>\n",
              "      <td>https://www.nytimes.com/2009/03/16/business/16...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>39</th>\n",
              "      <td>NEWS_2009-03-16_5382</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-03-16</td>\n",
              "      <td>A.I.G. Lists Banks It Paid With U.S. Bailout F...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>A.I.G. Lists Banks It Paid With U.S. Bailout F...</td>\n",
              "      <td>https://www.nytimes.com/2009/03/16/business/16...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>40</th>\n",
              "      <td>NEWS_2009-03-17_5921</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-03-17</td>\n",
              "      <td>Economic Data Offers a Balm as Fed Meets</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Economic Data Offers a Balm as Fed Meets An un...</td>\n",
              "      <td>https://www.nytimes.com/2009/03/18/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>41</th>\n",
              "      <td>NEWS_2009-03-20_7241</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-03-20</td>\n",
              "      <td>Mexico: Son of Cartel Leader Detained</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Mexico: Son of Cartel Leader Detained Soldiers...</td>\n",
              "      <td>https://www.nytimes.com/2009/03/20/world/ameri...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>42</th>\n",
              "      <td>NEWS_2009-08-13_5043</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-08-13</td>\n",
              "      <td>23 Filipino Soldiers Killed in Clashes</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>23 Filipino Soldiers Killed in Clashes MANILA ...</td>\n",
              "      <td>https://www.nytimes.com/2009/08/14/world/asia/...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>43</th>\n",
              "      <td>NEWS_2009-11-05_1453</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-11-05</td>\n",
              "      <td>Reports Show Conflicting Number of Jobs Attrib...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Reports Show Conflicting Number of Jobs Attrib...</td>\n",
              "      <td>https://www.nytimes.com/2009/11/05/us/05stimul...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>44</th>\n",
              "      <td>NEWS_2009-11-06_2104</td>\n",
              "      <td>news</td>\n",
              "      <td>2009-11-06</td>\n",
              "      <td>Explaining the Big Jump in Unemployment</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Explaining the Big Jump in Unemployment The un...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2009/11/06/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>45</th>\n",
              "      <td>NEWS_2010-03-19_6554</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-03-19</td>\n",
              "      <td>When Not to Pay Down a Mortgage</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>When Not to Pay Down a Mortgage This week, the...</td>\n",
              "      <td>https://www.nytimes.com/2010/03/20/your-money/...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>46</th>\n",
              "      <td>NEWS_2010-04-27_8403</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-04-27</td>\n",
              "      <td>How to Lower the Burden of Student Loans</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How to Lower the Burden of Student Loans Presi...</td>\n",
              "      <td>https://bucks.blogs.nytimes.com/2010/04/27/how...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>47</th>\n",
              "      <td>NEWS_2010-06-22_6819</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-06-22</td>\n",
              "      <td>Find an Angel Investor Before You Need One</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Find an Angel Investor Before You Need One Tin...</td>\n",
              "      <td>https://boss.blogs.nytimes.com/2010/06/22/find...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>48</th>\n",
              "      <td>NEWS_2010-08-10_2583</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-08-10</td>\n",
              "      <td>10-Year Treasury Yields Slide on Fed‚Äôs Decisio...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>10-Year Treasury Yields Slide on Fed‚Äôs Decisio...</td>\n",
              "      <td>https://www.nytimes.com/2010/08/11/business/11...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>49</th>\n",
              "      <td>NEWS_2010-08-11_2838</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-08-11</td>\n",
              "      <td>10-Year Treasury Yields Slide on Fed‚Äôs Decision</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>10-Year Treasury Yields Slide on Fed‚Äôs Decisio...</td>\n",
              "      <td>https://dealbook.nytimes.com/2010/08/11/10-yea...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50</th>\n",
              "      <td>NEWS_2010-09-21_6351</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-09-21</td>\n",
              "      <td>Fed Stands Pat and Says It Is Still Ready to B...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Stands Pat and Says It Is Still Ready to B...</td>\n",
              "      <td>https://www.nytimes.com/2010/09/22/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>51</th>\n",
              "      <td>NEWS_2010-09-22_6539</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-09-22</td>\n",
              "      <td>Fed Stands Pat and Says It Is Still Ready to B...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Stands Pat and Says It Is Still Ready to B...</td>\n",
              "      <td>https://dealbook.nytimes.com/2010/09/22/fed-st...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>52</th>\n",
              "      <td>NEWS_2010-09-24_7326</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-09-24</td>\n",
              "      <td>Banks Sitting Out Bond Surge as Lending Dries Up</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Banks Sitting Out Bond Surge as Lending Dries ...</td>\n",
              "      <td>https://dealbook.nytimes.com/2010/09/24/banks-...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>53</th>\n",
              "      <td>NEWS_2010-12-17_4969</td>\n",
              "      <td>news</td>\n",
              "      <td>2010-12-17</td>\n",
              "      <td>Keeping the Good News in Perspective</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Keeping the Good News in Perspective The most ...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2010/12/17/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7f2c332d-013f-4845-a64d-b49190008a1b')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-7f2c332d-013f-4845-a64d-b49190008a1b button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-7f2c332d-013f-4845-a64d-b49190008a1b');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-65e77595-0687-4a57-8291-95b037c5ce1d\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-65e77595-0687-4a57-8291-95b037c5ce1d')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-65e77595-0687-4a57-8291-95b037c5ce1d button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"run_nyt_archive_chunk(2005, 2010)\",\n  \"rows\": 54,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 54,\n        \"samples\": [\n          \"NEWS_2006-05-11_5150\",\n          \"NEWS_2010-08-11_2838\",\n          \"NEWS_2010-08-10_2583\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 48,\n        \"samples\": [\n          \"2007-03-22\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 48,\n        \"samples\": [\n          \"How Jobless Rates Forecast the Super Bowl\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 54,\n        \"samples\": [\n          \"The Start-Up as the First Step Up At age 7, Jabious Williams recalls, he walked a mile to a self-serve Exxon station where he offered to pump gas for tips. Working after school and on weekends, he said, he typically earned $30 to $50 a day to help support his single-parent family. Increasing numbers of entrepreneurs are mentoring low-income youth; offer financial support and contribute skills in effort to show young people new options; organizations such as Adopt-a-Class provide chance for successful businessmen to give back to community that helped them; many return to programs that offered them similar opportunities; photo (M) Increasing numbers of entrepreneurs are mentoring low-income youth; offer financial support and contribute skills in effort to show young people new options; organizations such as Adopt-a-Class provide chance for successful businessmen to give bac...\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 54,\n        \"samples\": [\n          \"https://www.nytimes.com/2006/05/11/business/the-startup-as-the-first-step-up.html\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"U.S.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 9,\n        \"samples\": [\n          \"National\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "run_nyt_archive_chunk(2011, 2016)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "IxbVQSrwMgon",
        "outputId": "26dda771-8618-41c9-815e-1624810e66b8"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "==============================\n",
            " NYT ARCHIVE CHUNK: 2011 ~ 2016\n",
            "==============================\n",
            "\n",
            "=== YEAR 2011 ===\n",
            " Fetching 2011-01 ...\n",
            "  docs: 8478\n",
            " Fetching 2011-02 ...\n",
            "  docs: 7917\n",
            " Fetching 2011-03 ...\n",
            "  docs: 9026\n",
            " Fetching 2011-04 ...\n",
            "  docs: 8751\n",
            " Fetching 2011-05 ...\n",
            "  docs: 8732\n",
            " Fetching 2011-06 ...\n",
            "  docs: 8602\n",
            " Fetching 2011-07 ...\n",
            "  docs: 7987\n",
            " Fetching 2011-08 ...\n",
            "  docs: 8138\n",
            " Fetching 2011-09 ...\n",
            "  docs: 9200\n",
            " Fetching 2011-10 ...\n",
            "  docs: 8912\n",
            " Fetching 2011-11 ...\n",
            "  docs: 8722\n",
            " Fetching 2011-12 ...\n",
            "  docs: 8504\n",
            "[SAVE] nyt_raw_partial_2011_2011.csv ‚Üí 8 rows\n",
            "=== YEAR 2012 ===\n",
            " Fetching 2012-01 ...\n",
            "  docs: 9168\n",
            " Fetching 2012-02 ...\n",
            "  docs: 8796\n",
            " Fetching 2012-03 ...\n",
            "  docs: 9280\n",
            " Fetching 2012-04 ...\n",
            "  docs: 8240\n",
            " Fetching 2012-05 ...\n",
            "  docs: 8862\n",
            " Fetching 2012-06 ...\n",
            "  docs: 8704\n",
            " Fetching 2012-07 ...\n",
            "  docs: 7795\n",
            " Fetching 2012-08 ...\n",
            "  docs: 8202\n",
            " Fetching 2012-09 ...\n",
            "  docs: 8306\n",
            " Fetching 2012-10 ...\n",
            "  docs: 8731\n",
            " Fetching 2012-11 ...\n",
            "  docs: 7959\n",
            " Fetching 2012-12 ...\n",
            "  docs: 7212\n",
            "[SAVE] nyt_raw_partial_2011_2012.csv ‚Üí 15 rows\n",
            "=== YEAR 2013 ===\n",
            " Fetching 2013-01 ...\n",
            "  docs: 7961\n",
            " Fetching 2013-02 ...\n",
            "  docs: 7504\n",
            " Fetching 2013-03 ...\n",
            "  docs: 8181\n",
            " Fetching 2013-04 ...\n",
            "  docs: 7616\n",
            " Fetching 2013-05 ...\n",
            "  docs: 7968\n",
            " Fetching 2013-06 ...\n",
            "  docs: 7401\n",
            " Fetching 2013-07 ...\n",
            "  docs: 6870\n",
            " Fetching 2013-08 ...\n",
            "  docs: 6634\n",
            " Fetching 2013-09 ...\n",
            "  docs: 7348\n",
            " Fetching 2013-10 ...\n",
            "  docs: 7711\n",
            " Fetching 2013-11 ...\n",
            "  docs: 7015\n",
            " Fetching 2013-12 ...\n",
            "  docs: 6775\n",
            "[SAVE] nyt_raw_partial_2011_2013.csv ‚Üí 25 rows\n",
            "=== YEAR 2014 ===\n",
            " Fetching 2014-01 ...\n",
            "  docs: 7337\n",
            " Fetching 2014-02 ...\n",
            "  docs: 6941\n",
            " Fetching 2014-03 ...\n",
            "  docs: 7187\n",
            " Fetching 2014-04 ...\n",
            "  docs: 7344\n",
            " Fetching 2014-05 ...\n",
            "  docs: 7549\n",
            " Fetching 2014-06 ...\n",
            "  docs: 7345\n",
            " Fetching 2014-07 ...\n",
            "  docs: 6814\n",
            " Fetching 2014-08 ...\n",
            "  docs: 6577\n",
            " Fetching 2014-09 ...\n",
            "  docs: 7585\n",
            " Fetching 2014-10 ...\n",
            "  docs: 7862\n",
            " Fetching 2014-11 ...\n",
            "  docs: 6709\n",
            " Fetching 2014-12 ...\n",
            "  docs: 6701\n",
            "[SAVE] nyt_raw_partial_2011_2014.csv ‚Üí 35 rows\n",
            "=== YEAR 2015 ===\n",
            " Fetching 2015-01 ...\n",
            "  docs: 6906\n",
            " Fetching 2015-02 ...\n",
            "  docs: 6437\n",
            " Fetching 2015-03 ...\n",
            "  docs: 6975\n",
            " Fetching 2015-04 ...\n",
            "  docs: 6542\n",
            " Fetching 2015-05 ...\n",
            "  docs: 6634\n",
            " Fetching 2015-06 ...\n",
            "  docs: 6947\n",
            " Fetching 2015-07 ...\n",
            "  docs: 6758\n",
            " Fetching 2015-08 ...\n",
            "  docs: 6086\n",
            " Fetching 2015-09 ...\n",
            "  docs: 6990\n",
            " Fetching 2015-10 ...\n",
            "  docs: 7365\n",
            " Fetching 2015-11 ...\n",
            "  docs: 6241\n",
            " Fetching 2015-12 ...\n",
            "  docs: 6371\n",
            "[SAVE] nyt_raw_partial_2011_2015.csv ‚Üí 37 rows\n",
            "=== YEAR 2016 ===\n",
            " Fetching 2016-01 ...\n",
            "  docs: 6265\n",
            " Fetching 2016-02 ...\n",
            "  docs: 6448\n",
            " Fetching 2016-03 ...\n",
            "  docs: 6487\n",
            " Fetching 2016-04 ...\n",
            "  docs: 5927\n",
            " Fetching 2016-05 ...\n",
            "  docs: 5921\n",
            " Fetching 2016-06 ...\n",
            "  docs: 5920\n",
            " Fetching 2016-07 ...\n",
            "  docs: 5594\n",
            " Fetching 2016-08 ...\n",
            "  docs: 5224\n",
            " Fetching 2016-09 ...\n",
            "  docs: 5894\n",
            " Fetching 2016-10 ...\n",
            "  docs: 5511\n",
            " Fetching 2016-11 ...\n",
            "  docs: 5331\n",
            " Fetching 2016-12 ...\n",
            "  docs: 4967\n",
            "[SAVE] nyt_raw_partial_2011_2016.csv ‚Üí 37 rows\n",
            "\n",
            "[FINISHED] Saved ‚Üí nyt_raw_2011_2016.csv (37 rows)\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                  doc_id doc_type        date  \\\n",
              "0   NEWS_2011-01-24_6375     news  2011-01-24   \n",
              "1   NEWS_2011-01-26_6997     news  2011-01-26   \n",
              "2   NEWS_2011-01-26_7009     news  2011-01-26   \n",
              "3   NEWS_2011-04-25_6762     news  2011-04-25   \n",
              "4   NEWS_2011-04-28_7570     news  2011-04-28   \n",
              "5   NEWS_2011-06-22_6157     news  2011-06-22   \n",
              "6   NEWS_2011-09-20_5771     news  2011-09-20   \n",
              "7   NEWS_2011-09-21_6151     news  2011-09-21   \n",
              "8   NEWS_2012-03-12_3253     news  2012-03-12   \n",
              "9   NEWS_2012-03-15_4420     news  2012-03-15   \n",
              "10  NEWS_2012-08-03_0814     news  2012-08-03   \n",
              "11  NEWS_2012-08-03_0819     news  2012-08-03   \n",
              "12  NEWS_2012-09-16_4393     news  2012-09-16   \n",
              "13  NEWS_2012-12-12_2918     news  2012-12-12   \n",
              "14  NEWS_2012-12-14_3621     news  2012-12-14   \n",
              "15  NEWS_2013-02-01_0123     news  2013-02-01   \n",
              "16  NEWS_2013-04-29_7213     news  2013-04-29   \n",
              "17  NEWS_2013-06-17_4103     news  2013-06-17   \n",
              "18  NEWS_2013-06-20_4794     news  2013-06-20   \n",
              "19  NEWS_2013-08-02_0389     news  2013-08-02   \n",
              "20  NEWS_2013-09-16_3645     news  2013-09-16   \n",
              "21  NEWS_2013-09-19_4504     news  2013-09-19   \n",
              "22  NEWS_2013-11-01_0215     news  2013-11-01   \n",
              "23  NEWS_2013-11-02_0411     news  2013-11-02   \n",
              "24  NEWS_2013-12-20_4777     news  2013-12-20   \n",
              "25  NEWS_2014-01-27_5917     news  2014-01-27   \n",
              "26  NEWS_2014-01-29_6607     news  2014-01-29   \n",
              "27  NEWS_2014-01-31_7099     news  2014-01-31   \n",
              "28  NEWS_2014-03-19_4187     news  2014-03-19   \n",
              "29  NEWS_2014-03-19_4270     news  2014-03-19   \n",
              "30  NEWS_2014-04-29_6764     news  2014-04-29   \n",
              "31  NEWS_2014-05-02_0404     news  2014-05-02   \n",
              "32  NEWS_2014-05-03_0631     news  2014-05-03   \n",
              "33  NEWS_2014-09-16_3810     news  2014-09-16   \n",
              "34  NEWS_2014-10-27_6364     news  2014-10-27   \n",
              "35  NEWS_2015-03-15_3329     news  2015-03-15   \n",
              "36  NEWS_2015-09-15_3216     news  2015-09-15   \n",
              "\n",
              "                                                title              source  \\\n",
              "0   When Competing With Big Banks, Smaller Can Be ...  The New York Times   \n",
              "1                 Fed to Continue Bond-Buying Program  The New York Times   \n",
              "2                          How to Choose an Incubator  The New York Times   \n",
              "3       A Tire Engineer‚Äôs Tips for Better Gas Mileage  The New York Times   \n",
              "4   Germany‚Äôs Low Unemployment Rate Stokes Inflati...  The New York Times   \n",
              "5   Some Ways to Get Started as a Social Entrepreneur  The New York Times   \n",
              "6            Greece Nears the Precipice, Raising Fear  The New York Times   \n",
              "7   Constraints on Central Banks Leave Markets Adrift  The New York Times   \n",
              "8         Looking Ahead to Economic Reports This Week  The New York Times   \n",
              "9        Republican Senators Propose Medicare Changes  The New York Times   \n",
              "10                            A Give-and-Take on Jobs  The New York Times   \n",
              "11     July Jobs Report Likely to Preserve Status Quo  The New York Times   \n",
              "12                Economic Reports for the Week Ahead  The New York Times   \n",
              "13  Fed Ties Rates to Joblessness, With Target of ...  The New York Times   \n",
              "14                  Risk Creeps Up in Long-Term Bonds  The New York Times   \n",
              "15     Marketing Tips for Reaching Hispanic Americans  The New York Times   \n",
              "16  As Jobs Lag, Fed Is Viewed as Unlikely to Do More  The New York Times   \n",
              "17                     Q. and A.: Is Congress Broken?  The New York Times   \n",
              "18                                Wall Street Jitters  The New York Times   \n",
              "19  U.S. Adds 162,000 Jobs as Growth Remains Sluggish  The New York Times   \n",
              "20  White House Warns Against Threats of Debt Default  The New York Times   \n",
              "21                   Fed Catches Wall St. by Surprise  The New York Times   \n",
              "22  F.C.C. Plans Sweeping Changes to Bolster AM Radio  The New York Times   \n",
              "23              Planning for a Needed Break From Work  The New York Times   \n",
              "24              Weak Recovery, but Comparatively Good  The New York Times   \n",
              "25               Proposal to Raise Tip Wages Resisted  The New York Times   \n",
              "26  Migration of Monarch Butterflies Shrinks Again...  The New York Times   \n",
              "27  Inflation in Euro Zone Falls, and a 12% Jobles...  The New York Times   \n",
              "28  More Fed Officials Say 2016 Is Year for Rate I...  The New York Times   \n",
              "29        Fed Cuts Bond Buying by Another $10 Billion  The New York Times   \n",
              "30  Pfizer Proposes a Marriage With AstraZeneca, E...  The New York Times   \n",
              "31  Jump in Payrolls Is Seen as a Sign of New Opti...  The New York Times   \n",
              "32  Democrats Struggle to Turn Economic Gains Into...  The New York Times   \n",
              "33                   1939: Women Adopt Military Style  The New York Times   \n",
              "34  Peace Prize Laureates Urge Disclosure on U.S. ...  The New York Times   \n",
              "35  Fed‚Äôs Steps on Interest Rates and Data on Hous...  The New York Times   \n",
              "36  Quest for Yield Still Trumping Safety in Debt ...  The New York Times   \n",
              "\n",
              "   language                                           raw_text  \\\n",
              "0        en  When Competing With Big Banks, Smaller Can Be ...   \n",
              "1        en  Fed to Continue Bond-Buying Program WASHINGTON...   \n",
              "2        en  How to Choose an Incubator IN 1956, a hardware...   \n",
              "3        en  A Tire Engineer‚Äôs Tips for Better Gas Mileage ...   \n",
              "4        en  Germany‚Äôs Low Unemployment Rate Stokes Inflati...   \n",
              "5        en  Some Ways to Get Started as a Social Entrepren...   \n",
              "6        en  Greece Nears the Precipice, Raising Fear Slowe...   \n",
              "7        en  Constraints on Central Banks Leave Markets Adr...   \n",
              "8        en  Looking Ahead to Economic Reports This Week EC...   \n",
              "9        en  Republican Senators Propose Medicare Changes F...   \n",
              "10       en  A Give-and-Take on Jobs Friday‚Äôs monthly jobs ...   \n",
              "11       en  July Jobs Report Likely to Preserve Status Quo...   \n",
              "12       en  Economic Reports for the Week Ahead ECONOMIC R...   \n",
              "13       en  Fed Ties Rates to Joblessness, With Target of ...   \n",
              "14       en  Risk Creeps Up in Long-Term Bonds THE Federal ...   \n",
              "15       en  Marketing Tips for Reaching Hispanic Americans...   \n",
              "16       en  As Jobs Lag, Fed Is Viewed as Unlikely to Do M...   \n",
              "17       en  Q. and A.: Is Congress Broken? On Sept. 18, 20...   \n",
              "18       en  Wall Street Jitters The Federal Reserve expect...   \n",
              "19       en  U.S. Adds 162,000 Jobs as Growth Remains Slugg...   \n",
              "20       en  White House Warns Against Threats of Debt Defa...   \n",
              "21       en  Fed Catches Wall St. by Surprise CONFUSION AND...   \n",
              "22       en  F.C.C. Plans Sweeping Changes to Bolster AM Ra...   \n",
              "23       en  Planning for a Needed Break From Work JOSEPH B...   \n",
              "24       en  Weak Recovery, but Comparatively Good INDUSTRI...   \n",
              "25       en  Proposal to Raise Tip Wages Resisted Nearly 50...   \n",
              "26       en  Migration of Monarch Butterflies Shrinks Again...   \n",
              "27       en  Inflation in Euro Zone Falls, and a 12% Jobles...   \n",
              "28       en  More Fed Officials Say 2016 Is Year for Rate I...   \n",
              "29       en  Fed Cuts Bond Buying by Another $10 Billion WA...   \n",
              "30       en  Pfizer Proposes a Marriage With AstraZeneca, E...   \n",
              "31       en  Jump in Payrolls Is Seen as a Sign of New Opti...   \n",
              "32       en  Democrats Struggle to Turn Economic Gains Into...   \n",
              "33       en  1939: Women Adopt Military Style LONDON ‚Äî Fash...   \n",
              "34       en  Peace Prize Laureates Urge Disclosure on U.S. ...   \n",
              "35       en  Fed‚Äôs Steps on Interest Rates and Data on Hous...   \n",
              "36       en  Quest for Yield Still Trumping Safety in Debt ...   \n",
              "\n",
              "                                              web_url  section_name news_desk  \n",
              "0   https://dealbook.nytimes.com/2011/01/24/boutiq...  Business Day            \n",
              "1   https://www.nytimes.com/2011/01/27/business/ec...  Business Day  Business  \n",
              "2   https://www.nytimes.com/2011/01/27/business/sm...  Business Day  Business  \n",
              "3   https://bucks.blogs.nytimes.com/2011/04/25/a-t...    Your Money            \n",
              "4   https://www.nytimes.com/2011/04/29/business/29...  Business Day  Business  \n",
              "5   https://www.nytimes.com/2011/06/23/business/sm...  Business Day  Business  \n",
              "6   https://www.nytimes.com/2011/09/20/business/gl...  Business Day  Business  \n",
              "7   https://www.nytimes.com/2011/09/22/business/gl...  Business Day  Business  \n",
              "8   https://www.nytimes.com/2012/03/12/business/ec...  Business Day  Business  \n",
              "9   https://thecaucus.blogs.nytimes.com/2012/03/15...          U.S.            \n",
              "10  https://economix.blogs.nytimes.com/2012/08/03/...  Business Day            \n",
              "11  https://fivethirtyeight.blogs.nytimes.com/2012...          U.S.            \n",
              "12  https://www.nytimes.com/2012/09/17/business/ec...  Business Day  Business  \n",
              "13  https://www.nytimes.com/2012/12/13/business/ec...  Business Day  Business  \n",
              "14  https://www.nytimes.com/2012/12/15/business/ri...  Business Day  Business  \n",
              "15  https://boss.blogs.nytimes.com/2013/02/01/mark...  Business Day            \n",
              "16  https://www.nytimes.com/2013/04/30/business/ec...  Business Day  Business  \n",
              "17  https://thecaucus.blogs.nytimes.com/2013/06/17...          U.S.            \n",
              "18  https://dealbook.nytimes.com/2013/06/20/wall-s...  Business Day            \n",
              "19  https://www.nytimes.com/2013/08/03/business/ec...  Business Day  Business  \n",
              "20  https://www.nytimes.com/2013/09/16/business/ec...  Business Day  Business  \n",
              "21  https://dealbook.nytimes.com/2013/09/19/mornin...  Business Day            \n",
              "22  https://www.nytimes.com/2013/11/02/business/me...  Business Day  Business  \n",
              "23  https://www.nytimes.com/2013/11/02/your-money/...    Your Money  Business  \n",
              "24  https://www.nytimes.com/2013/12/21/business/ec...  Business Day  Business  \n",
              "25  https://www.nytimes.com/2014/01/27/business/pr...  Business Day  Business  \n",
              "26  https://www.nytimes.com/2014/01/30/us/monarch-...          U.S.  National  \n",
              "27  https://www.nytimes.com/2014/02/01/business/in...  Business Day  Business  \n",
              "28  https://economix.blogs.nytimes.com/2014/03/19/...  Business Day  Business  \n",
              "29  https://www.nytimes.com/2014/03/20/business/fe...  Business Day  Business  \n",
              "30  https://dealbook.nytimes.com/2014/04/28/pfizer...  Business Day  Business  \n",
              "31  https://www.nytimes.com/2014/05/03/business/ec...  Business Day  Business  \n",
              "32  https://www.nytimes.com/2014/05/03/us/politics...          U.S.  National  \n",
              "33  https://iht-retrospective.blogs.nytimes.com/20...         World   Foreign  \n",
              "34  https://www.nytimes.com/2014/10/27/us/politics...          U.S.   Foreign  \n",
              "35  https://www.nytimes.com/2015/03/16/business/fe...  Business Day  Business  \n",
              "36  https://www.nytimes.com/2015/09/16/business/de...  Business Day  Business  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-e1c64891-74fc-415a-98c2-0c8d632b5887\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_2011-01-24_6375</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-01-24</td>\n",
              "      <td>When Competing With Big Banks, Smaller Can Be ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>When Competing With Big Banks, Smaller Can Be ...</td>\n",
              "      <td>https://dealbook.nytimes.com/2011/01/24/boutiq...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_2011-01-26_6997</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-01-26</td>\n",
              "      <td>Fed to Continue Bond-Buying Program</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed to Continue Bond-Buying Program WASHINGTON...</td>\n",
              "      <td>https://www.nytimes.com/2011/01/27/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_2011-01-26_7009</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-01-26</td>\n",
              "      <td>How to Choose an Incubator</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How to Choose an Incubator IN 1956, a hardware...</td>\n",
              "      <td>https://www.nytimes.com/2011/01/27/business/sm...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_2011-04-25_6762</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-04-25</td>\n",
              "      <td>A Tire Engineer‚Äôs Tips for Better Gas Mileage</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>A Tire Engineer‚Äôs Tips for Better Gas Mileage ...</td>\n",
              "      <td>https://bucks.blogs.nytimes.com/2011/04/25/a-t...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_2011-04-28_7570</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-04-28</td>\n",
              "      <td>Germany‚Äôs Low Unemployment Rate Stokes Inflati...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Germany‚Äôs Low Unemployment Rate Stokes Inflati...</td>\n",
              "      <td>https://www.nytimes.com/2011/04/29/business/29...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>NEWS_2011-06-22_6157</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-06-22</td>\n",
              "      <td>Some Ways to Get Started as a Social Entrepreneur</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Some Ways to Get Started as a Social Entrepren...</td>\n",
              "      <td>https://www.nytimes.com/2011/06/23/business/sm...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6</th>\n",
              "      <td>NEWS_2011-09-20_5771</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-09-20</td>\n",
              "      <td>Greece Nears the Precipice, Raising Fear</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Greece Nears the Precipice, Raising Fear Slowe...</td>\n",
              "      <td>https://www.nytimes.com/2011/09/20/business/gl...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>7</th>\n",
              "      <td>NEWS_2011-09-21_6151</td>\n",
              "      <td>news</td>\n",
              "      <td>2011-09-21</td>\n",
              "      <td>Constraints on Central Banks Leave Markets Adrift</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Constraints on Central Banks Leave Markets Adr...</td>\n",
              "      <td>https://www.nytimes.com/2011/09/22/business/gl...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>8</th>\n",
              "      <td>NEWS_2012-03-12_3253</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-03-12</td>\n",
              "      <td>Looking Ahead to Economic Reports This Week</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Looking Ahead to Economic Reports This Week EC...</td>\n",
              "      <td>https://www.nytimes.com/2012/03/12/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9</th>\n",
              "      <td>NEWS_2012-03-15_4420</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-03-15</td>\n",
              "      <td>Republican Senators Propose Medicare Changes</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Republican Senators Propose Medicare Changes F...</td>\n",
              "      <td>https://thecaucus.blogs.nytimes.com/2012/03/15...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10</th>\n",
              "      <td>NEWS_2012-08-03_0814</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-08-03</td>\n",
              "      <td>A Give-and-Take on Jobs</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>A Give-and-Take on Jobs Friday‚Äôs monthly jobs ...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2012/08/03/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>11</th>\n",
              "      <td>NEWS_2012-08-03_0819</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-08-03</td>\n",
              "      <td>July Jobs Report Likely to Preserve Status Quo</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>July Jobs Report Likely to Preserve Status Quo...</td>\n",
              "      <td>https://fivethirtyeight.blogs.nytimes.com/2012...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>12</th>\n",
              "      <td>NEWS_2012-09-16_4393</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-09-16</td>\n",
              "      <td>Economic Reports for the Week Ahead</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Economic Reports for the Week Ahead ECONOMIC R...</td>\n",
              "      <td>https://www.nytimes.com/2012/09/17/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>13</th>\n",
              "      <td>NEWS_2012-12-12_2918</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-12-12</td>\n",
              "      <td>Fed Ties Rates to Joblessness, With Target of ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Ties Rates to Joblessness, With Target of ...</td>\n",
              "      <td>https://www.nytimes.com/2012/12/13/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>14</th>\n",
              "      <td>NEWS_2012-12-14_3621</td>\n",
              "      <td>news</td>\n",
              "      <td>2012-12-14</td>\n",
              "      <td>Risk Creeps Up in Long-Term Bonds</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Risk Creeps Up in Long-Term Bonds THE Federal ...</td>\n",
              "      <td>https://www.nytimes.com/2012/12/15/business/ri...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>15</th>\n",
              "      <td>NEWS_2013-02-01_0123</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-02-01</td>\n",
              "      <td>Marketing Tips for Reaching Hispanic Americans</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Marketing Tips for Reaching Hispanic Americans...</td>\n",
              "      <td>https://boss.blogs.nytimes.com/2013/02/01/mark...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>16</th>\n",
              "      <td>NEWS_2013-04-29_7213</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-04-29</td>\n",
              "      <td>As Jobs Lag, Fed Is Viewed as Unlikely to Do More</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>As Jobs Lag, Fed Is Viewed as Unlikely to Do M...</td>\n",
              "      <td>https://www.nytimes.com/2013/04/30/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>17</th>\n",
              "      <td>NEWS_2013-06-17_4103</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-06-17</td>\n",
              "      <td>Q. and A.: Is Congress Broken?</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Q. and A.: Is Congress Broken? On Sept. 18, 20...</td>\n",
              "      <td>https://thecaucus.blogs.nytimes.com/2013/06/17...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>18</th>\n",
              "      <td>NEWS_2013-06-20_4794</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-06-20</td>\n",
              "      <td>Wall Street Jitters</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Wall Street Jitters The Federal Reserve expect...</td>\n",
              "      <td>https://dealbook.nytimes.com/2013/06/20/wall-s...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>19</th>\n",
              "      <td>NEWS_2013-08-02_0389</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-08-02</td>\n",
              "      <td>U.S. Adds 162,000 Jobs as Growth Remains Sluggish</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>U.S. Adds 162,000 Jobs as Growth Remains Slugg...</td>\n",
              "      <td>https://www.nytimes.com/2013/08/03/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>20</th>\n",
              "      <td>NEWS_2013-09-16_3645</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-09-16</td>\n",
              "      <td>White House Warns Against Threats of Debt Default</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>White House Warns Against Threats of Debt Defa...</td>\n",
              "      <td>https://www.nytimes.com/2013/09/16/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>21</th>\n",
              "      <td>NEWS_2013-09-19_4504</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-09-19</td>\n",
              "      <td>Fed Catches Wall St. by Surprise</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Catches Wall St. by Surprise CONFUSION AND...</td>\n",
              "      <td>https://dealbook.nytimes.com/2013/09/19/mornin...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td></td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>22</th>\n",
              "      <td>NEWS_2013-11-01_0215</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-11-01</td>\n",
              "      <td>F.C.C. Plans Sweeping Changes to Bolster AM Radio</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>F.C.C. Plans Sweeping Changes to Bolster AM Ra...</td>\n",
              "      <td>https://www.nytimes.com/2013/11/02/business/me...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>23</th>\n",
              "      <td>NEWS_2013-11-02_0411</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-11-02</td>\n",
              "      <td>Planning for a Needed Break From Work</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Planning for a Needed Break From Work JOSEPH B...</td>\n",
              "      <td>https://www.nytimes.com/2013/11/02/your-money/...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>24</th>\n",
              "      <td>NEWS_2013-12-20_4777</td>\n",
              "      <td>news</td>\n",
              "      <td>2013-12-20</td>\n",
              "      <td>Weak Recovery, but Comparatively Good</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Weak Recovery, but Comparatively Good INDUSTRI...</td>\n",
              "      <td>https://www.nytimes.com/2013/12/21/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25</th>\n",
              "      <td>NEWS_2014-01-27_5917</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-01-27</td>\n",
              "      <td>Proposal to Raise Tip Wages Resisted</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Proposal to Raise Tip Wages Resisted Nearly 50...</td>\n",
              "      <td>https://www.nytimes.com/2014/01/27/business/pr...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>26</th>\n",
              "      <td>NEWS_2014-01-29_6607</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-01-29</td>\n",
              "      <td>Migration of Monarch Butterflies Shrinks Again...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Migration of Monarch Butterflies Shrinks Again...</td>\n",
              "      <td>https://www.nytimes.com/2014/01/30/us/monarch-...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>27</th>\n",
              "      <td>NEWS_2014-01-31_7099</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-01-31</td>\n",
              "      <td>Inflation in Euro Zone Falls, and a 12% Jobles...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Inflation in Euro Zone Falls, and a 12% Jobles...</td>\n",
              "      <td>https://www.nytimes.com/2014/02/01/business/in...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>28</th>\n",
              "      <td>NEWS_2014-03-19_4187</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-03-19</td>\n",
              "      <td>More Fed Officials Say 2016 Is Year for Rate I...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>More Fed Officials Say 2016 Is Year for Rate I...</td>\n",
              "      <td>https://economix.blogs.nytimes.com/2014/03/19/...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29</th>\n",
              "      <td>NEWS_2014-03-19_4270</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-03-19</td>\n",
              "      <td>Fed Cuts Bond Buying by Another $10 Billion</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Cuts Bond Buying by Another $10 Billion WA...</td>\n",
              "      <td>https://www.nytimes.com/2014/03/20/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>30</th>\n",
              "      <td>NEWS_2014-04-29_6764</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-04-29</td>\n",
              "      <td>Pfizer Proposes a Marriage With AstraZeneca, E...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Pfizer Proposes a Marriage With AstraZeneca, E...</td>\n",
              "      <td>https://dealbook.nytimes.com/2014/04/28/pfizer...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>31</th>\n",
              "      <td>NEWS_2014-05-02_0404</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-05-02</td>\n",
              "      <td>Jump in Payrolls Is Seen as a Sign of New Opti...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Jump in Payrolls Is Seen as a Sign of New Opti...</td>\n",
              "      <td>https://www.nytimes.com/2014/05/03/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>32</th>\n",
              "      <td>NEWS_2014-05-03_0631</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-05-03</td>\n",
              "      <td>Democrats Struggle to Turn Economic Gains Into...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Democrats Struggle to Turn Economic Gains Into...</td>\n",
              "      <td>https://www.nytimes.com/2014/05/03/us/politics...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>33</th>\n",
              "      <td>NEWS_2014-09-16_3810</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-09-16</td>\n",
              "      <td>1939: Women Adopt Military Style</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>1939: Women Adopt Military Style LONDON ‚Äî Fash...</td>\n",
              "      <td>https://iht-retrospective.blogs.nytimes.com/20...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>34</th>\n",
              "      <td>NEWS_2014-10-27_6364</td>\n",
              "      <td>news</td>\n",
              "      <td>2014-10-27</td>\n",
              "      <td>Peace Prize Laureates Urge Disclosure on U.S. ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Peace Prize Laureates Urge Disclosure on U.S. ...</td>\n",
              "      <td>https://www.nytimes.com/2014/10/27/us/politics...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>Foreign</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>35</th>\n",
              "      <td>NEWS_2015-03-15_3329</td>\n",
              "      <td>news</td>\n",
              "      <td>2015-03-15</td>\n",
              "      <td>Fed‚Äôs Steps on Interest Rates and Data on Hous...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed‚Äôs Steps on Interest Rates and Data on Hous...</td>\n",
              "      <td>https://www.nytimes.com/2015/03/16/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>36</th>\n",
              "      <td>NEWS_2015-09-15_3216</td>\n",
              "      <td>news</td>\n",
              "      <td>2015-09-15</td>\n",
              "      <td>Quest for Yield Still Trumping Safety in Debt ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Quest for Yield Still Trumping Safety in Debt ...</td>\n",
              "      <td>https://www.nytimes.com/2015/09/16/business/de...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e1c64891-74fc-415a-98c2-0c8d632b5887')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-e1c64891-74fc-415a-98c2-0c8d632b5887 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-e1c64891-74fc-415a-98c2-0c8d632b5887');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-c3877b28-1822-405c-9a87-44c064e1c962\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-c3877b28-1822-405c-9a87-44c064e1c962')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-c3877b28-1822-405c-9a87-44c064e1c962 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"run_nyt_archive_chunk(2011, 2016)\",\n  \"rows\": 37,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 37,\n        \"samples\": [\n          \"NEWS_2013-06-17_4103\",\n          \"NEWS_2012-12-12_2918\",\n          \"NEWS_2011-04-28_7570\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"2013-06-17\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 37,\n        \"samples\": [\n          \"Q. and A.: Is Congress Broken?\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 37,\n        \"samples\": [\n          \"Q. and A.: Is Congress Broken? On Sept. 18, 2008, with the nation on the precipice of a financial crisis, Treasury Secretary Henry Paulson told House Speaker Nancy Pelosi to gather a bipartisan group of lawmakers that very day. Congress quickly passed the bailout, but it was not until July 2010 that President Obama signed a sweeping overhaul of the financial system meant to prevent another Great Recession. Robert G. Kaiser, a veteran Washington Post reporter and author, explains how the Dodd-Frank bill inspired his pessimism about Congress\\u2019s ability to address big problems. Robert G. Kaiser, a veteran Washington Post reporter and author, explains how the Dodd-Frank bill inspired his pessimism about Congress\\u2019s ability to address big problems.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 37,\n        \"samples\": [\n          \"https://thecaucus.blogs.nytimes.com/2013/06/17/q-and-a-is-congress-broken/\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"Your Money\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"Business\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 8
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "run_nyt_archive_chunk(2017, 2025)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "XHBlkEs9QaPV",
        "outputId": "06b16ba7-1c0d-4cc9-d41c-7f494e1726ea"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "==============================\n",
            " NYT ARCHIVE CHUNK: 2017 ~ 2025\n",
            "==============================\n",
            "\n",
            "=== YEAR 2017 ===\n",
            " Fetching 2017-01 ...\n",
            "  docs: 5129\n",
            " Fetching 2017-02 ...\n",
            "  docs: 4935\n",
            " Fetching 2017-03 ...\n",
            "  docs: 5546\n",
            " Fetching 2017-04 ...\n",
            "  docs: 4878\n",
            " Fetching 2017-05 ...\n",
            "  docs: 5384\n",
            " Fetching 2017-06 ...\n",
            "  docs: 5300\n",
            " Fetching 2017-07 ...\n",
            "  docs: 4757\n",
            " Fetching 2017-08 ...\n",
            "  docs: 4854\n",
            " Fetching 2017-09 ...\n",
            "  docs: 5033\n",
            " Fetching 2017-10 ...\n",
            "  docs: 5214\n",
            " Fetching 2017-11 ...\n",
            "  docs: 4834\n",
            " Fetching 2017-12 ...\n",
            "  docs: 4560\n",
            "[SAVE] nyt_raw_partial_2017_2017.csv ‚Üí 2 rows\n",
            "=== YEAR 2018 ===\n",
            " Fetching 2018-01 ...\n",
            "  docs: 4757\n",
            " Fetching 2018-02 ...\n",
            "  docs: 4573\n",
            " Fetching 2018-03 ...\n",
            "  docs: 5034\n",
            " Fetching 2018-04 ...\n",
            "  docs: 4655\n",
            " Fetching 2018-05 ...\n",
            "  docs: 5127\n",
            " Fetching 2018-06 ...\n",
            "  docs: 4988\n",
            " Fetching 2018-07 ...\n",
            "  docs: 4444\n",
            " Fetching 2018-08 ...\n",
            "  docs: 6381\n",
            " Fetching 2018-09 ...\n",
            "  docs: 4722\n",
            " Fetching 2018-10 ...\n",
            "  docs: 5146\n",
            " Fetching 2018-11 ...\n",
            "  docs: 4829\n",
            " Fetching 2018-12 ...\n",
            "  docs: 4193\n",
            "[SAVE] nyt_raw_partial_2017_2018.csv ‚Üí 4 rows\n",
            "=== YEAR 2019 ===\n",
            " Fetching 2019-01 ...\n",
            "  docs: 4482\n",
            " Fetching 2019-02 ...\n",
            "  docs: 4122\n",
            " Fetching 2019-03 ...\n",
            "  docs: 4690\n",
            " Fetching 2019-04 ...\n",
            "  docs: 4523\n",
            " Fetching 2019-05 ...\n",
            "  docs: 4737\n",
            " Fetching 2019-06 ...\n",
            "  docs: 4496\n",
            " Fetching 2019-07 ...\n",
            "  docs: 4287\n",
            " Fetching 2019-08 ...\n",
            "  docs: 4109\n",
            " Fetching 2019-09 ...\n",
            "  docs: 4418\n",
            " Fetching 2019-10 ...\n",
            "  docs: 4989\n",
            " Fetching 2019-11 ...\n",
            "  docs: 4420\n",
            " Fetching 2019-12 ...\n",
            "  docs: 3985\n",
            "[SAVE] nyt_raw_partial_2017_2019.csv ‚Üí 9 rows\n",
            "=== YEAR 2020 ===\n",
            " Fetching 2020-01 ...\n",
            "  docs: 4480\n",
            " Fetching 2020-02 ...\n",
            "  docs: 4240\n",
            " Fetching 2020-03 ...\n",
            "  docs: 4883\n",
            " Fetching 2020-04 ...\n",
            "  docs: 5019\n",
            " Fetching 2020-05 ...\n",
            "  docs: 4347\n",
            " Fetching 2020-06 ...\n",
            "  docs: 4492\n",
            " Fetching 2020-07 ...\n",
            "  docs: 4459\n",
            " Fetching 2020-08 ...\n",
            "  docs: 4439\n",
            " Fetching 2020-09 ...\n",
            "  docs: 4609\n",
            " Fetching 2020-10 ...\n",
            "  docs: 5257\n",
            " Fetching 2020-11 ...\n",
            "  docs: 5114\n",
            " Fetching 2020-12 ...\n",
            "  docs: 4154\n",
            "[SAVE] nyt_raw_partial_2017_2020.csv ‚Üí 12 rows\n",
            "=== YEAR 2021 ===\n",
            " Fetching 2021-01 ...\n",
            "  docs: 7001\n",
            " Fetching 2021-02 ...\n",
            "  docs: 4260\n",
            " Fetching 2021-03 ...\n",
            "  docs: 4786\n",
            " Fetching 2021-04 ...\n",
            "  docs: 4592\n",
            " Fetching 2021-05 ...\n",
            "  docs: 4265\n",
            " Fetching 2021-06 ...\n",
            "  docs: 4260\n",
            " Fetching 2021-07 ...\n",
            "  docs: 4467\n",
            " Fetching 2021-08 ...\n",
            "  docs: 4223\n",
            " Fetching 2021-09 ...\n",
            "  docs: 4482\n",
            " Fetching 2021-10 ...\n",
            "  docs: 4254\n",
            " Fetching 2021-11 ...\n",
            "  docs: 4006\n",
            " Fetching 2021-12 ...\n",
            "  docs: 3933\n",
            "[SAVE] nyt_raw_partial_2017_2021.csv ‚Üí 16 rows\n",
            "=== YEAR 2022 ===\n",
            " Fetching 2022-01 ...\n",
            "  docs: 3799\n",
            " Fetching 2022-02 ...\n",
            "  docs: 4059\n",
            " Fetching 2022-03 ...\n",
            "  docs: 4310\n",
            " Fetching 2022-04 ...\n",
            "  docs: 3934\n",
            " Fetching 2022-05 ...\n",
            "  docs: 4179\n",
            " Fetching 2022-06 ...\n",
            "  docs: 4374\n",
            " Fetching 2022-07 ...\n",
            "  docs: 3835\n",
            " Fetching 2022-08 ...\n",
            "  docs: 3983\n",
            " Fetching 2022-09 ...\n",
            "  docs: 4087\n",
            " Fetching 2022-10 ...\n",
            "  docs: 3857\n",
            " Fetching 2022-11 ...\n",
            "  docs: 4742\n",
            " Fetching 2022-12 ...\n",
            "  docs: 3548\n",
            "[SAVE] nyt_raw_partial_2017_2022.csv ‚Üí 25 rows\n",
            "=== YEAR 2023 ===\n",
            " Fetching 2023-01 ...\n",
            "  docs: 3423\n",
            " Fetching 2023-02 ...\n",
            "  docs: 3260\n",
            " Fetching 2023-03 ...\n",
            "  docs: 5769\n",
            " Fetching 2023-04 ...\n",
            "  docs: 3718\n",
            " Fetching 2023-05 ...\n",
            "  docs: 3881\n",
            " Fetching 2023-06 ...\n",
            "  docs: 3788\n",
            " Fetching 2023-07 ...\n",
            "  docs: 3548\n",
            " Fetching 2023-08 ...\n",
            "  docs: 3668\n",
            " Fetching 2023-09 ...\n",
            "  docs: 3823\n",
            " Fetching 2023-10 ...\n",
            "  docs: 3906\n",
            " Fetching 2023-11 ...\n",
            "  docs: 3734\n",
            " Fetching 2023-12 ...\n",
            "  docs: 3525\n",
            "[SAVE] nyt_raw_partial_2017_2023.csv ‚Üí 27 rows\n",
            "=== YEAR 2024 ===\n",
            " Fetching 2024-01 ...\n",
            "  docs: 3785\n",
            " Fetching 2024-02 ...\n",
            "  docs: 3791\n",
            " Fetching 2024-03 ...\n",
            "  docs: 4242\n",
            " Fetching 2024-04 ...\n",
            "  docs: 3954\n",
            " Fetching 2024-05 ...\n",
            "  docs: 4268\n",
            " Fetching 2024-06 ...\n",
            "  docs: 3847\n",
            " Fetching 2024-07 ...\n",
            "  docs: 4134\n",
            " Fetching 2024-08 ...\n",
            "  docs: 4047\n",
            " Fetching 2024-09 ...\n",
            "  docs: 4054\n",
            " Fetching 2024-10 ...\n",
            "  docs: 4306\n",
            " Fetching 2024-11 ...\n",
            "  docs: 4602\n",
            " Fetching 2024-12 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2024-12 failed too many times.\n",
            "[SAVE] nyt_raw_partial_2017_2024.csv ‚Üí 34 rows\n",
            "=== YEAR 2025 ===\n",
            " Fetching 2025-01 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-01 failed too many times.\n",
            " Fetching 2025-02 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-02 failed too many times.\n",
            " Fetching 2025-03 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-03 failed too many times.\n",
            " Fetching 2025-04 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-04 failed too many times.\n",
            " Fetching 2025-05 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-05 failed too many times.\n",
            " Fetching 2025-06 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-06 failed too many times.\n",
            " Fetching 2025-07 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-07 failed too many times.\n",
            " Fetching 2025-08 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-08 failed too many times.\n",
            " Fetching 2025-09 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-09 failed too many times.\n",
            " Fetching 2025-10 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-10 failed too many times.\n",
            " Fetching 2025-11 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-11 failed too many times.\n",
            " Fetching 2025-12 ...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  ‚Üí 429 Too Many Requests, waiting 15 sec...\n",
            "  [SKIP] 2025-12 failed too many times.\n",
            "[SAVE] nyt_raw_partial_2017_2025.csv ‚Üí 34 rows\n",
            "\n",
            "[FINISHED] Saved ‚Üí nyt_raw_2017_2025.csv (34 rows)\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                  doc_id doc_type        date  \\\n",
              "0   NEWS_2017-03-13_2166     news  2017-03-13   \n",
              "1   NEWS_2017-05-03_0562     news  2017-05-03   \n",
              "2   NEWS_2018-05-02_0211     news  2018-05-02   \n",
              "3   NEWS_2018-09-28_4410     news  2018-09-28   \n",
              "4   NEWS_2019-03-22_3363     news  2019-03-22   \n",
              "5   NEWS_2019-07-29_3859     news  2019-07-29   \n",
              "6   NEWS_2019-07-31_4213     news  2019-07-31   \n",
              "7   NEWS_2019-08-01_0061     news  2019-08-01   \n",
              "8   NEWS_2019-10-31_4838     news  2019-10-31   \n",
              "9   NEWS_2020-06-10_1333     news  2020-06-10   \n",
              "10  NEWS_2020-09-17_2405     news  2020-09-17   \n",
              "11  NEWS_2020-11-03_0301     news  2020-11-03   \n",
              "12  NEWS_2021-03-19_2933     news  2021-03-19   \n",
              "13  NEWS_2021-06-14_1881     news  2021-06-14   \n",
              "14  NEWS_2021-06-17_2489     news  2021-06-17   \n",
              "15  NEWS_2021-07-30_4307     news  2021-07-30   \n",
              "16  NEWS_2022-03-16_2306     news  2022-03-16   \n",
              "17  NEWS_2022-05-06_0758     news  2022-05-06   \n",
              "18  NEWS_2022-06-15_2025     news  2022-06-15   \n",
              "19  NEWS_2022-06-15_2076     news  2022-06-15   \n",
              "20  NEWS_2022-06-16_2222     news  2022-06-16   \n",
              "21  NEWS_2022-09-18_2338     news  2022-09-18   \n",
              "22  NEWS_2022-09-23_3101     news  2022-09-23   \n",
              "23  NEWS_2022-11-03_0382     news  2022-11-03   \n",
              "24  NEWS_2022-11-04_0571     news  2022-11-04   \n",
              "25  NEWS_2023-09-18_2148     news  2023-09-18   \n",
              "26  NEWS_2023-12-13_1695     news  2023-12-13   \n",
              "27  NEWS_2024-03-21_3028     news  2024-03-21   \n",
              "28  NEWS_2024-08-02_0290     news  2024-08-02   \n",
              "29  NEWS_2024-09-17_2075     news  2024-09-17   \n",
              "30  NEWS_2024-09-18_2345     news  2024-09-18   \n",
              "31  NEWS_2024-09-19_2480     news  2024-09-19   \n",
              "32  NEWS_2024-11-07_1805     news  2024-11-07   \n",
              "33  NEWS_2024-11-09_2080     news  2024-11-09   \n",
              "\n",
              "                                                title              source  \\\n",
              "0   Competition in Job Market Lets Professionals S...  The New York Times   \n",
              "1             Tips for Financing That Home Remodeling  The New York Times   \n",
              "2   Teacher Pay Is So Low in Some U.S. School Dist...  The New York Times   \n",
              "3   So You‚Äôve Frozen Your Credit Files. Here Are T...  The New York Times   \n",
              "4   Stocks Fall as Bond Market Flashes a Recession...  The New York Times   \n",
              "5   Pfizer to Merge Its Off-Patent Drug Unit With ...  The New York Times   \n",
              "6   The Fed Just Cut Interest Rates. Here‚Äôs What T...  The New York Times   \n",
              "7   Mortgage Rates Are Already Lower. They‚Äôre Not ...  The New York Times   \n",
              "8   The Housing Market Needs More Than Low Mortgag...  The New York Times   \n",
              "9          Fed Expects Unemployment Rate to Stay High  The New York Times   \n",
              "10            A wave of job searches has yet to come.  The New York Times   \n",
              "11  Two final swing state polls give Biden a sligh...  The New York Times   \n",
              "12  R√©sum√©-Writing Tips to Help You Get Past the A...  The New York Times   \n",
              "13  Inflation expectations jump, another data poin...  The New York Times   \n",
              "14  The Air Quality Index Explained: What It Means...  The New York Times   \n",
              "15  How Disabled Americans Are Pushing to Overhaul...  The New York Times   \n",
              "16  Iran‚Äôs Attack Was Response to Secret Israeli A...  The New York Times   \n",
              "17          How Long Can the Hot Job Market Continue?  The New York Times   \n",
              "18  Real estate companies lay off workers amid ‚Äòcl...  The New York Times   \n",
              "19  What the Fed‚Äôs rate increase means for mortgages.  The New York Times   \n",
              "20  Mortgage rates jump to 5.78 percent, rising at...  The New York Times   \n",
              "21          The Week in Business: Rail Strike Averted  The New York Times   \n",
              "22  Global Markets Fall on Worries About Inflation...  The New York Times   \n",
              "23  Mortgage Rates Too High? (Blame the Fed, Wall ...  The New York Times   \n",
              "24  Workers Expect Fast Inflation Next Year. Could...  The New York Times   \n",
              "25  How DeSantis Played Both Sides of the G.O.P. R...  The New York Times   \n",
              "26  Stocks Rally and Bond Yields Slide as Fed Sign...  The New York Times   \n",
              "27               Friday Briefing: The U.S. Sues Apple  The New York Times   \n",
              "28  Jolted by Soft Jobs Report, Stocks Tumble to E...  The New York Times   \n",
              "29  Will Lower Rates Unleash a Business Boom? It‚Äôs...  The New York Times   \n",
              "30  Valarie D‚ÄôElia, Travel Reporter on TV and Radi...  The New York Times   \n",
              "31  30-Year Mortgage Rate Drops to 6.09% After Fed...  The New York Times   \n",
              "32  If the Fed Is Cutting Rates, Why Are Mortgage ...  The New York Times   \n",
              "33  Could the Bond Market Stymie Trump‚Äôs Economic ...  The New York Times   \n",
              "\n",
              "   language                                           raw_text  \\\n",
              "0        en  Competition in Job Market Lets Professionals S...   \n",
              "1        en  Tips for Financing That Home Remodeling Summer...   \n",
              "2        en  Teacher Pay Is So Low in Some U.S. School Dist...   \n",
              "3        en  So You‚Äôve Frozen Your Credit Files. Here Are T...   \n",
              "4        en  Stocks Fall as Bond Market Flashes a Recession...   \n",
              "5        en  Pfizer to Merge Its Off-Patent Drug Unit With ...   \n",
              "6        en  The Fed Just Cut Interest Rates. Here‚Äôs What T...   \n",
              "7        en  Mortgage Rates Are Already Lower. They‚Äôre Not ...   \n",
              "8        en  The Housing Market Needs More Than Low Mortgag...   \n",
              "9        en  Fed Expects Unemployment Rate to Stay High The...   \n",
              "10       en  A wave of job searches has yet to come. When t...   \n",
              "11       en  Two final swing state polls give Biden a sligh...   \n",
              "12       en  R√©sum√©-Writing Tips to Help You Get Past the A...   \n",
              "13       en  Inflation expectations jump, another data poin...   \n",
              "14       en  The Air Quality Index Explained: What It Means...   \n",
              "15       en  How Disabled Americans Are Pushing to Overhaul...   \n",
              "16       en  Iran‚Äôs Attack Was Response to Secret Israeli A...   \n",
              "17       en  How Long Can the Hot Job Market Continue? This...   \n",
              "18       en  Real estate companies lay off workers amid ‚Äòcl...   \n",
              "19       en  What the Fed‚Äôs rate increase means for mortgag...   \n",
              "20       en  Mortgage rates jump to 5.78 percent, rising at...   \n",
              "21       en  The Week in Business: Rail Strike Averted With...   \n",
              "22       en  Global Markets Fall on Worries About Inflation...   \n",
              "23       en  Mortgage Rates Too High? (Blame the Fed, Wall ...   \n",
              "24       en  Workers Expect Fast Inflation Next Year. Could...   \n",
              "25       en  How DeSantis Played Both Sides of the G.O.P. R...   \n",
              "26       en  Stocks Rally and Bond Yields Slide as Fed Sign...   \n",
              "27       en  Friday Briefing: The U.S. Sues Apple The Justi...   \n",
              "28       en  Jolted by Soft Jobs Report, Stocks Tumble to E...   \n",
              "29       en  Will Lower Rates Unleash a Business Boom? It‚Äôs...   \n",
              "30       en  Valarie D‚ÄôElia, Travel Reporter on TV and Radi...   \n",
              "31       en  30-Year Mortgage Rate Drops to 6.09% After Fed...   \n",
              "32       en  If the Fed Is Cutting Rates, Why Are Mortgage ...   \n",
              "33       en  Could the Bond Market Stymie Trump‚Äôs Economic ...   \n",
              "\n",
              "                                              web_url  section_name  \\\n",
              "0   https://www.nytimes.com/2017/03/13/business/co...  Business Day   \n",
              "1   https://www.nytimes.com/2017/05/03/business/ho...  Business Day   \n",
              "2   https://www.nytimes.com/2018/05/02/us/arizona-...          U.S.   \n",
              "3   https://www.nytimes.com/2018/09/28/your-money/...    Your Money   \n",
              "4   https://www.nytimes.com/2019/03/22/business/yi...  Business Day   \n",
              "5   https://www.nytimes.com/2019/07/29/business/de...  Business Day   \n",
              "6   https://www.nytimes.com/2019/07/31/your-money/...    Your Money   \n",
              "7   https://www.nytimes.com/2019/08/01/business/in...  Business Day   \n",
              "8   https://www.nytimes.com/2019/10/31/business/ec...  Business Day   \n",
              "9   https://www.nytimes.com/2020/06/10/business/st...  Business Day   \n",
              "10  https://www.nytimes.com/2020/09/17/business/a-...  Business Day   \n",
              "11  https://www.nytimes.com/2020/11/02/us/politics...          U.S.   \n",
              "12  https://www.nytimes.com/2021/03/19/business/re...  Business Day   \n",
              "13  https://www.nytimes.com/2021/06/14/business/su...  Business Day   \n",
              "14  https://www.nytimes.com/article/air-quality-in...          U.S.   \n",
              "15  https://www.nytimes.com/2021/07/30/us/politics...          U.S.   \n",
              "16  https://www.nytimes.com/2022/03/16/world/middl...         World   \n",
              "17  https://www.nytimes.com/2022/05/06/business/de...  Business Day   \n",
              "18  https://www.nytimes.com/2022/06/15/business/re...  Business Day   \n",
              "19  https://www.nytimes.com/2022/06/15/business/ec...  Business Day   \n",
              "20  https://www.nytimes.com/2022/06/16/business/mo...  Business Day   \n",
              "21  https://www.nytimes.com/2022/09/18/business/th...  Business Day   \n",
              "22  https://www.nytimes.com/2022/09/23/business/gl...  Business Day   \n",
              "23  https://www.nytimes.com/2022/11/03/business/mo...  Business Day   \n",
              "24  https://www.nytimes.com/2022/11/04/business/ec...  Business Day   \n",
              "25  https://www.nytimes.com/2023/09/18/us/politics...          U.S.   \n",
              "26  https://www.nytimes.com/2023/12/13/business/st...  Business Day   \n",
              "27  https://www.nytimes.com/2024/03/21/world/asia/...         World   \n",
              "28  https://www.nytimes.com/2024/08/02/business/ec...  Business Day   \n",
              "29  https://www.nytimes.com/2024/09/17/business/ec...  Business Day   \n",
              "30  https://www.nytimes.com/2024/09/18/business/me...  Business Day   \n",
              "31  https://www.nytimes.com/2024/09/19/business/mo...  Business Day   \n",
              "32  https://www.nytimes.com/2024/11/07/business/fe...  Business Day   \n",
              "33  https://www.nytimes.com/2024/11/09/business/de...  Business Day   \n",
              "\n",
              "         news_desk  \n",
              "0         Business  \n",
              "1         Business  \n",
              "2         National  \n",
              "3         Business  \n",
              "4         Business  \n",
              "5         Business  \n",
              "6         Business  \n",
              "7         Business  \n",
              "8         Business  \n",
              "9         Business  \n",
              "10        Business  \n",
              "11        Politics  \n",
              "12        Business  \n",
              "13        Business  \n",
              "14        National  \n",
              "15        Politics  \n",
              "16         Foreign  \n",
              "17        Business  \n",
              "18        Business  \n",
              "19        Business  \n",
              "20        Business  \n",
              "21  SundayBusiness  \n",
              "22        Business  \n",
              "23        Business  \n",
              "24        Business  \n",
              "25        Politics  \n",
              "26        Business  \n",
              "27          NYTNow  \n",
              "28        Business  \n",
              "29        Business  \n",
              "30           Obits  \n",
              "31        Business  \n",
              "32        Business  \n",
              "33        Business  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-c6d71d41-42c4-42dc-9945-4689104bdc74\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_2017-03-13_2166</td>\n",
              "      <td>news</td>\n",
              "      <td>2017-03-13</td>\n",
              "      <td>Competition in Job Market Lets Professionals S...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Competition in Job Market Lets Professionals S...</td>\n",
              "      <td>https://www.nytimes.com/2017/03/13/business/co...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_2017-05-03_0562</td>\n",
              "      <td>news</td>\n",
              "      <td>2017-05-03</td>\n",
              "      <td>Tips for Financing That Home Remodeling</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Tips for Financing That Home Remodeling Summer...</td>\n",
              "      <td>https://www.nytimes.com/2017/05/03/business/ho...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_2018-05-02_0211</td>\n",
              "      <td>news</td>\n",
              "      <td>2018-05-02</td>\n",
              "      <td>Teacher Pay Is So Low in Some U.S. School Dist...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Teacher Pay Is So Low in Some U.S. School Dist...</td>\n",
              "      <td>https://www.nytimes.com/2018/05/02/us/arizona-...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_2018-09-28_4410</td>\n",
              "      <td>news</td>\n",
              "      <td>2018-09-28</td>\n",
              "      <td>So You‚Äôve Frozen Your Credit Files. Here Are T...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>So You‚Äôve Frozen Your Credit Files. Here Are T...</td>\n",
              "      <td>https://www.nytimes.com/2018/09/28/your-money/...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_2019-03-22_3363</td>\n",
              "      <td>news</td>\n",
              "      <td>2019-03-22</td>\n",
              "      <td>Stocks Fall as Bond Market Flashes a Recession...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Stocks Fall as Bond Market Flashes a Recession...</td>\n",
              "      <td>https://www.nytimes.com/2019/03/22/business/yi...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>NEWS_2019-07-29_3859</td>\n",
              "      <td>news</td>\n",
              "      <td>2019-07-29</td>\n",
              "      <td>Pfizer to Merge Its Off-Patent Drug Unit With ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Pfizer to Merge Its Off-Patent Drug Unit With ...</td>\n",
              "      <td>https://www.nytimes.com/2019/07/29/business/de...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>6</th>\n",
              "      <td>NEWS_2019-07-31_4213</td>\n",
              "      <td>news</td>\n",
              "      <td>2019-07-31</td>\n",
              "      <td>The Fed Just Cut Interest Rates. Here‚Äôs What T...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Fed Just Cut Interest Rates. Here‚Äôs What T...</td>\n",
              "      <td>https://www.nytimes.com/2019/07/31/your-money/...</td>\n",
              "      <td>Your Money</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>7</th>\n",
              "      <td>NEWS_2019-08-01_0061</td>\n",
              "      <td>news</td>\n",
              "      <td>2019-08-01</td>\n",
              "      <td>Mortgage Rates Are Already Lower. They‚Äôre Not ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Mortgage Rates Are Already Lower. They‚Äôre Not ...</td>\n",
              "      <td>https://www.nytimes.com/2019/08/01/business/in...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>8</th>\n",
              "      <td>NEWS_2019-10-31_4838</td>\n",
              "      <td>news</td>\n",
              "      <td>2019-10-31</td>\n",
              "      <td>The Housing Market Needs More Than Low Mortgag...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Housing Market Needs More Than Low Mortgag...</td>\n",
              "      <td>https://www.nytimes.com/2019/10/31/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>9</th>\n",
              "      <td>NEWS_2020-06-10_1333</td>\n",
              "      <td>news</td>\n",
              "      <td>2020-06-10</td>\n",
              "      <td>Fed Expects Unemployment Rate to Stay High</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Fed Expects Unemployment Rate to Stay High The...</td>\n",
              "      <td>https://www.nytimes.com/2020/06/10/business/st...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>10</th>\n",
              "      <td>NEWS_2020-09-17_2405</td>\n",
              "      <td>news</td>\n",
              "      <td>2020-09-17</td>\n",
              "      <td>A wave of job searches has yet to come.</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>A wave of job searches has yet to come. When t...</td>\n",
              "      <td>https://www.nytimes.com/2020/09/17/business/a-...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>11</th>\n",
              "      <td>NEWS_2020-11-03_0301</td>\n",
              "      <td>news</td>\n",
              "      <td>2020-11-03</td>\n",
              "      <td>Two final swing state polls give Biden a sligh...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Two final swing state polls give Biden a sligh...</td>\n",
              "      <td>https://www.nytimes.com/2020/11/02/us/politics...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>Politics</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>12</th>\n",
              "      <td>NEWS_2021-03-19_2933</td>\n",
              "      <td>news</td>\n",
              "      <td>2021-03-19</td>\n",
              "      <td>R√©sum√©-Writing Tips to Help You Get Past the A...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>R√©sum√©-Writing Tips to Help You Get Past the A...</td>\n",
              "      <td>https://www.nytimes.com/2021/03/19/business/re...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>13</th>\n",
              "      <td>NEWS_2021-06-14_1881</td>\n",
              "      <td>news</td>\n",
              "      <td>2021-06-14</td>\n",
              "      <td>Inflation expectations jump, another data poin...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Inflation expectations jump, another data poin...</td>\n",
              "      <td>https://www.nytimes.com/2021/06/14/business/su...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>14</th>\n",
              "      <td>NEWS_2021-06-17_2489</td>\n",
              "      <td>news</td>\n",
              "      <td>2021-06-17</td>\n",
              "      <td>The Air Quality Index Explained: What It Means...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Air Quality Index Explained: What It Means...</td>\n",
              "      <td>https://www.nytimes.com/article/air-quality-in...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>National</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>15</th>\n",
              "      <td>NEWS_2021-07-30_4307</td>\n",
              "      <td>news</td>\n",
              "      <td>2021-07-30</td>\n",
              "      <td>How Disabled Americans Are Pushing to Overhaul...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How Disabled Americans Are Pushing to Overhaul...</td>\n",
              "      <td>https://www.nytimes.com/2021/07/30/us/politics...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>Politics</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>16</th>\n",
              "      <td>NEWS_2022-03-16_2306</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-03-16</td>\n",
              "      <td>Iran‚Äôs Attack Was Response to Secret Israeli A...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Iran‚Äôs Attack Was Response to Secret Israeli A...</td>\n",
              "      <td>https://www.nytimes.com/2022/03/16/world/middl...</td>\n",
              "      <td>World</td>\n",
              "      <td>Foreign</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>17</th>\n",
              "      <td>NEWS_2022-05-06_0758</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-05-06</td>\n",
              "      <td>How Long Can the Hot Job Market Continue?</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How Long Can the Hot Job Market Continue? This...</td>\n",
              "      <td>https://www.nytimes.com/2022/05/06/business/de...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>18</th>\n",
              "      <td>NEWS_2022-06-15_2025</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-06-15</td>\n",
              "      <td>Real estate companies lay off workers amid ‚Äòcl...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Real estate companies lay off workers amid ‚Äòcl...</td>\n",
              "      <td>https://www.nytimes.com/2022/06/15/business/re...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>19</th>\n",
              "      <td>NEWS_2022-06-15_2076</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-06-15</td>\n",
              "      <td>What the Fed‚Äôs rate increase means for mortgages.</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>What the Fed‚Äôs rate increase means for mortgag...</td>\n",
              "      <td>https://www.nytimes.com/2022/06/15/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>20</th>\n",
              "      <td>NEWS_2022-06-16_2222</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-06-16</td>\n",
              "      <td>Mortgage rates jump to 5.78 percent, rising at...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Mortgage rates jump to 5.78 percent, rising at...</td>\n",
              "      <td>https://www.nytimes.com/2022/06/16/business/mo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>21</th>\n",
              "      <td>NEWS_2022-09-18_2338</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-09-18</td>\n",
              "      <td>The Week in Business: Rail Strike Averted</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>The Week in Business: Rail Strike Averted With...</td>\n",
              "      <td>https://www.nytimes.com/2022/09/18/business/th...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>SundayBusiness</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>22</th>\n",
              "      <td>NEWS_2022-09-23_3101</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-09-23</td>\n",
              "      <td>Global Markets Fall on Worries About Inflation...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Global Markets Fall on Worries About Inflation...</td>\n",
              "      <td>https://www.nytimes.com/2022/09/23/business/gl...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>23</th>\n",
              "      <td>NEWS_2022-11-03_0382</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-11-03</td>\n",
              "      <td>Mortgage Rates Too High? (Blame the Fed, Wall ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Mortgage Rates Too High? (Blame the Fed, Wall ...</td>\n",
              "      <td>https://www.nytimes.com/2022/11/03/business/mo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>24</th>\n",
              "      <td>NEWS_2022-11-04_0571</td>\n",
              "      <td>news</td>\n",
              "      <td>2022-11-04</td>\n",
              "      <td>Workers Expect Fast Inflation Next Year. Could...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Workers Expect Fast Inflation Next Year. Could...</td>\n",
              "      <td>https://www.nytimes.com/2022/11/04/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25</th>\n",
              "      <td>NEWS_2023-09-18_2148</td>\n",
              "      <td>news</td>\n",
              "      <td>2023-09-18</td>\n",
              "      <td>How DeSantis Played Both Sides of the G.O.P. R...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>How DeSantis Played Both Sides of the G.O.P. R...</td>\n",
              "      <td>https://www.nytimes.com/2023/09/18/us/politics...</td>\n",
              "      <td>U.S.</td>\n",
              "      <td>Politics</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>26</th>\n",
              "      <td>NEWS_2023-12-13_1695</td>\n",
              "      <td>news</td>\n",
              "      <td>2023-12-13</td>\n",
              "      <td>Stocks Rally and Bond Yields Slide as Fed Sign...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Stocks Rally and Bond Yields Slide as Fed Sign...</td>\n",
              "      <td>https://www.nytimes.com/2023/12/13/business/st...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>27</th>\n",
              "      <td>NEWS_2024-03-21_3028</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-03-21</td>\n",
              "      <td>Friday Briefing: The U.S. Sues Apple</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Friday Briefing: The U.S. Sues Apple The Justi...</td>\n",
              "      <td>https://www.nytimes.com/2024/03/21/world/asia/...</td>\n",
              "      <td>World</td>\n",
              "      <td>NYTNow</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>28</th>\n",
              "      <td>NEWS_2024-08-02_0290</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-08-02</td>\n",
              "      <td>Jolted by Soft Jobs Report, Stocks Tumble to E...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Jolted by Soft Jobs Report, Stocks Tumble to E...</td>\n",
              "      <td>https://www.nytimes.com/2024/08/02/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29</th>\n",
              "      <td>NEWS_2024-09-17_2075</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-09-17</td>\n",
              "      <td>Will Lower Rates Unleash a Business Boom? It‚Äôs...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Will Lower Rates Unleash a Business Boom? It‚Äôs...</td>\n",
              "      <td>https://www.nytimes.com/2024/09/17/business/ec...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>30</th>\n",
              "      <td>NEWS_2024-09-18_2345</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-09-18</td>\n",
              "      <td>Valarie D‚ÄôElia, Travel Reporter on TV and Radi...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Valarie D‚ÄôElia, Travel Reporter on TV and Radi...</td>\n",
              "      <td>https://www.nytimes.com/2024/09/18/business/me...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Obits</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>31</th>\n",
              "      <td>NEWS_2024-09-19_2480</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-09-19</td>\n",
              "      <td>30-Year Mortgage Rate Drops to 6.09% After Fed...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>30-Year Mortgage Rate Drops to 6.09% After Fed...</td>\n",
              "      <td>https://www.nytimes.com/2024/09/19/business/mo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>32</th>\n",
              "      <td>NEWS_2024-11-07_1805</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-11-07</td>\n",
              "      <td>If the Fed Is Cutting Rates, Why Are Mortgage ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>If the Fed Is Cutting Rates, Why Are Mortgage ...</td>\n",
              "      <td>https://www.nytimes.com/2024/11/07/business/fe...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>33</th>\n",
              "      <td>NEWS_2024-11-09_2080</td>\n",
              "      <td>news</td>\n",
              "      <td>2024-11-09</td>\n",
              "      <td>Could the Bond Market Stymie Trump‚Äôs Economic ...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Could the Bond Market Stymie Trump‚Äôs Economic ...</td>\n",
              "      <td>https://www.nytimes.com/2024/11/09/business/de...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Business</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c6d71d41-42c4-42dc-9945-4689104bdc74')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-c6d71d41-42c4-42dc-9945-4689104bdc74 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-c6d71d41-42c4-42dc-9945-4689104bdc74');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-b5e52457-c812-445d-9a53-66a15b8dd3d4\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-b5e52457-c812-445d-9a53-66a15b8dd3d4')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-b5e52457-c812-445d-9a53-66a15b8dd3d4 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"run_nyt_archive_chunk(2017, 2025)\",\n  \"rows\": 34,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"NEWS_2021-07-30_4307\",\n          \"NEWS_2022-06-15_2076\",\n          \"NEWS_2024-03-21_3028\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 33,\n        \"samples\": [\n          \"2024-11-07\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"How Disabled Americans Are Pushing to Overhaul a Key Benefits Program\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"How Disabled Americans Are Pushing to Overhaul a Key Benefits Program When Congress created Supplemental Security Income in 1972, it left no question about its intentions. The program, lawmakers wrote, was \\u201cdesigned to provide a positive assurance that the nation\\u2019s aged, blind and disabled people would no longer have to subsist on below-poverty-level incomes.\\u201d Many older, blind and disabled Americans receive benefits from the Supplemental Security Income program. But it has been essentially unchanged since 1972, and its rules mean that many recipients must remain in poverty. Many older, blind and disabled Americans receive benefits from the Supplemental Security Income program. But it has been essentially unchanged since 1972, and its rules mean that many recipients must remain in poverty.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"https://www.nytimes.com/2021/07/30/us/politics/disability-benefits-ssi-congress.html\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"U.S.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 7,\n        \"samples\": [\n          \"Business\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "'''\n",
        "run_nyt_archive_chunk(1993, 1998)\n",
        "run_nyt_archive_chunk(1999, 2004)\n",
        "run_nyt_archive_chunk(2005, 2010)\n",
        "run_nyt_archive_chunk(2011, 2016)\n",
        "run_nyt_archive_chunk(2017, 2025)\n",
        "'''"
      ],
      "metadata": {
        "id": "YdpVyz574ibl"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "‚≠ê 5. ÎßàÏßÄÎßâÏóê Ìï©ÏπòÍ∏∞"
      ],
      "metadata": {
        "id": "2UeMSz2G4lHq"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "files = [\n",
        "    \"nyt_raw_1993_1998.csv\",\n",
        "    \"nyt_raw_1999_2004.csv\",\n",
        "    \"nyt_raw_2005_2010.csv\",\n",
        "    \"nyt_raw_2011_2016.csv\",\n",
        "    \"nyt_raw_2017_2025.csv\",\n",
        "]\n",
        "nyt_all = pd.concat([pd.read_csv(f) for f in files], ignore_index=True)\n",
        "nyt_all.to_csv(\"nyt_raw_all.csv\", index=False)\n",
        "len(nyt_all)\n",
        "\n",
        "nyt_all.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 666
        },
        "id": "cf1uuBbs4kcF",
        "outputId": "87a09ffd-eada-4aef-b706-6adaefe0860d"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                 doc_id doc_type        date  \\\n",
              "0  NEWS_1993-02-06_1177     news  1993-02-06   \n",
              "1  NEWS_1993-02-06_1198     news  1993-02-06   \n",
              "2  NEWS_1993-05-15_3521     news  1993-05-15   \n",
              "3  NEWS_1993-07-08_1460     news  1993-07-08   \n",
              "4  NEWS_1993-08-20_4857     news  1993-08-20   \n",
              "\n",
              "                                               title              source  \\\n",
              "0  JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...  The New York Times   \n",
              "1                                    BUSINESS DIGEST  The New York Times   \n",
              "2                      U.S. Industry's Sluggish Pace  The New York Times   \n",
              "3                     Treasury Yields Stay Near Lows  The New York Times   \n",
              "4                  U.S. Tries To Halt Fall Of Dollar  The New York Times   \n",
              "\n",
              "  language                                           raw_text  \\\n",
              "0       en  JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...   \n",
              "1       en  BUSINESS DIGEST The Economy   The Economy   Ne...   \n",
              "2       en  U.S. Industry's Sluggish Pace People have been...   \n",
              "3       en  Treasury Yields Stay Near Lows Interest rates ...   \n",
              "4       en  U.S. Tries To Halt Fall Of Dollar The Clinton ...   \n",
              "\n",
              "                                             web_url  section_name  \\\n",
              "0  https://www.nytimes.com/1993/02/06/business/jo...  Business Day   \n",
              "1  https://www.nytimes.com/1993/02/06/business/bu...  Business Day   \n",
              "2  https://www.nytimes.com/1993/05/15/business/us...  Business Day   \n",
              "3  https://www.nytimes.com/1993/07/08/business/cr...  Business Day   \n",
              "4  https://www.nytimes.com/1993/08/20/business/cu...  Business Day   \n",
              "\n",
              "        news_desk  \n",
              "0  Financial Desk  \n",
              "1  Financial Desk  \n",
              "2  Financial Desk  \n",
              "3  Financial Desk  \n",
              "4  Financial Desk  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-669780cc-38ec-4820-8c01-b3a9bfc1019b\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>web_url</th>\n",
              "      <th>section_name</th>\n",
              "      <th>news_desk</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_1993-02-06_1177</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-02-06</td>\n",
              "      <td>JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>JOBLESS RATE HITS A 25-YEAR RECORD IN NEW YORK...</td>\n",
              "      <td>https://www.nytimes.com/1993/02/06/business/jo...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_1993-02-06_1198</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-02-06</td>\n",
              "      <td>BUSINESS DIGEST</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>BUSINESS DIGEST The Economy   The Economy   Ne...</td>\n",
              "      <td>https://www.nytimes.com/1993/02/06/business/bu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_1993-05-15_3521</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-05-15</td>\n",
              "      <td>U.S. Industry's Sluggish Pace</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>U.S. Industry's Sluggish Pace People have been...</td>\n",
              "      <td>https://www.nytimes.com/1993/05/15/business/us...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_1993-07-08_1460</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-07-08</td>\n",
              "      <td>Treasury Yields Stay Near Lows</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Treasury Yields Stay Near Lows Interest rates ...</td>\n",
              "      <td>https://www.nytimes.com/1993/07/08/business/cr...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_1993-08-20_4857</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-08-20</td>\n",
              "      <td>U.S. Tries To Halt Fall Of Dollar</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>U.S. Tries To Halt Fall Of Dollar The Clinton ...</td>\n",
              "      <td>https://www.nytimes.com/1993/08/20/business/cu...</td>\n",
              "      <td>Business Day</td>\n",
              "      <td>Financial Desk</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-669780cc-38ec-4820-8c01-b3a9bfc1019b')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-669780cc-38ec-4820-8c01-b3a9bfc1019b button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-669780cc-38ec-4820-8c01-b3a9bfc1019b');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-83940383-6a33-4ea9-b1aa-3d27acc2c6c6\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-83940383-6a33-4ea9-b1aa-3d27acc2c6c6')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-83940383-6a33-4ea9-b1aa-3d27acc2c6c6 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "nyt_all",
              "summary": "{\n  \"name\": \"nyt_all\",\n  \"rows\": 347,\n  \"fields\": [\n    {\n      \"column\": \"doc_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 347,\n        \"samples\": [\n          \"NEWS_2020-06-10_1333\",\n          \"NEWS_1999-07-02_0499\",\n          \"NEWS_2021-03-19_2933\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"doc_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"news\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 289,\n        \"samples\": [\n          \"1997-10-03\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"title\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 284,\n        \"samples\": [\n          \"A New Framework for Health Care\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"source\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"The New York Times\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"language\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"en\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"raw_text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 347,\n        \"samples\": [\n          \"Fed Expects Unemployment Rate to Stay High The Federal Reserve left interest rates unchanged and near zero on Wednesday as the central bank projected a slow economic recovery from the pandemic-induced recession. The latest on stock market and business news during the coronavirus outbreak. The latest on stock market and business news during the coronavirus outbreak.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"web_url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 347,\n        \"samples\": [\n          \"https://www.nytimes.com/2020/06/10/business/stock-market-today-coronavirus.html\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"section_name\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"U.S.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"news_desk\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 15,\n        \"samples\": [\n          \"SundayBusiness\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 10
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "nyt_all['date'] = pd.to_datetime(nyt_all['date'])\n",
        "nyt_all['year'] = nyt_all['date'].dt.year\n",
        "nyt_all['year'].value_counts().sort_index()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "mS-kvck2bZ-j",
        "outputId": "660f42d7-f907-44ff-d812-db99324b4b07"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "year\n",
              "1993    1129\n",
              "1994    1127\n",
              "1995    1133\n",
              "1996    1080\n",
              "1997     932\n",
              "1998    1026\n",
              "1999    1005\n",
              "2000    1159\n",
              "2001    2279\n",
              "2002    1693\n",
              "2003    1480\n",
              "2004    1628\n",
              "2005    1539\n",
              "2006    2415\n",
              "2007    1184\n",
              "2008    1552\n",
              "2009    1437\n",
              "2010    1070\n",
              "2011     899\n",
              "2012     915\n",
              "2013     892\n",
              "2014     851\n",
              "2015     798\n",
              "2016     559\n",
              "2017     506\n",
              "2018     555\n",
              "2019     528\n",
              "2020     798\n",
              "2021     474\n",
              "2022     495\n",
              "2023     554\n",
              "2024     552\n",
              "2025     219\n",
              "Name: count, dtype: int64"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>count</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>year</th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>1993</th>\n",
              "      <td>1129</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1994</th>\n",
              "      <td>1127</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1995</th>\n",
              "      <td>1133</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1996</th>\n",
              "      <td>1080</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1997</th>\n",
              "      <td>932</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1998</th>\n",
              "      <td>1026</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1999</th>\n",
              "      <td>1005</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2000</th>\n",
              "      <td>1159</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2001</th>\n",
              "      <td>2279</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2002</th>\n",
              "      <td>1693</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2003</th>\n",
              "      <td>1480</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2004</th>\n",
              "      <td>1628</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2005</th>\n",
              "      <td>1539</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2006</th>\n",
              "      <td>2415</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2007</th>\n",
              "      <td>1184</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2008</th>\n",
              "      <td>1552</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2009</th>\n",
              "      <td>1437</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2010</th>\n",
              "      <td>1070</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2011</th>\n",
              "      <td>899</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2012</th>\n",
              "      <td>915</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2013</th>\n",
              "      <td>892</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2014</th>\n",
              "      <td>851</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2015</th>\n",
              "      <td>798</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2016</th>\n",
              "      <td>559</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2017</th>\n",
              "      <td>506</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2018</th>\n",
              "      <td>555</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019</th>\n",
              "      <td>528</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2020</th>\n",
              "      <td>798</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2021</th>\n",
              "      <td>474</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2022</th>\n",
              "      <td>495</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2023</th>\n",
              "      <td>554</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2024</th>\n",
              "      <td>552</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2025</th>\n",
              "      <td>219</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> int64</label>"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "for f in files:\n",
        "    print(f, len(pd.read_csv(f)))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "zkz4j4VhbfjD",
        "outputId": "29592e15-2b7e-46b0-d1cb-b94c4909e20f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "nyt_raw_1993_1998.csv 6427\n",
            "nyt_raw_1999_2004.csv 9244\n",
            "nyt_raw_2005_2010.csv 9197\n",
            "nyt_raw_2011_2016.csv 4914\n",
            "nyt_raw_2017_2025.csv 4681\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Ïó¨Í∏∞ÍπåÏßÄÍ∞Ä ‚ÄúÍ∏∞Í∞Ñ/Ïñë/Îâ¥Ïä§ÏÇ¨/Ï°∞Í±¥‚ÄùÏùÑ Ï†ÅÏö©Ìï¥ÏÑú NYTÏóêÏÑú Í∞ÄÏ†∏Ïò§Îäî Îã®Í≥ÑÏïº."
      ],
      "metadata": {
        "id": "tIqLWRRf2xr8"
      }
    },
    {
      "cell_type": "markdown",
      "source": [
        "2Îã®Í≥Ñ Ï†ÑÏ≤òÎ¶¨"
      ],
      "metadata": {
        "id": "PbxzjSG13Zt9"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install spacy\n",
        "!python -m spacy download en_core_web_sm"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "0kYUKRUk3agO",
        "outputId": "2fddf5c8-48bf-46e4-c3a5-6d4c41bfc4c2"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: spacy in /usr/local/lib/python3.12/dist-packages (3.8.8)\n",
            "Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.11 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.0.12)\n",
            "Requirement already satisfied: spacy-loggers<2.0.0,>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.0.5)\n",
            "Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.0.13)\n",
            "Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.11)\n",
            "Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.0.10)\n",
            "Requirement already satisfied: thinc<8.4.0,>=8.3.4 in /usr/local/lib/python3.12/dist-packages (from spacy) (8.3.8)\n",
            "Requirement already satisfied: wasabi<1.2.0,>=0.9.1 in /usr/local/lib/python3.12/dist-packages (from spacy) (1.1.3)\n",
            "Requirement already satisfied: srsly<3.0.0,>=2.4.3 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.5.1)\n",
            "Requirement already satisfied: catalogue<2.1.0,>=2.0.6 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.10)\n",
            "Requirement already satisfied: weasel<0.5.0,>=0.4.2 in /usr/local/lib/python3.12/dist-packages (from spacy) (0.4.2)\n",
            "Requirement already satisfied: typer-slim<1.0.0,>=0.3.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (0.20.0)\n",
            "Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (4.67.1)\n",
            "Requirement already satisfied: numpy>=1.19.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.0.2)\n",
            "Requirement already satisfied: requests<3.0.0,>=2.13.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.32.4)\n",
            "Requirement already satisfied: pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4 in /usr/local/lib/python3.12/dist-packages (from spacy) (2.11.10)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from spacy) (3.1.6)\n",
            "Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from spacy) (75.2.0)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.12/dist-packages (from spacy) (25.0)\n",
            "Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy) (0.7.0)\n",
            "Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy) (2.33.2)\n",
            "Requirement already satisfied: typing-extensions>=4.12.2 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy) (4.15.0)\n",
            "Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.12/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy) (0.4.2)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.13.0->spacy) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.13.0->spacy) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.13.0->spacy) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3.0.0,>=2.13.0->spacy) (2025.10.5)\n",
            "Requirement already satisfied: blis<1.4.0,>=1.3.0 in /usr/local/lib/python3.12/dist-packages (from thinc<8.4.0,>=8.3.4->spacy) (1.3.0)\n",
            "Requirement already satisfied: confection<1.0.0,>=0.0.1 in /usr/local/lib/python3.12/dist-packages (from thinc<8.4.0,>=8.3.4->spacy) (0.1.5)\n",
            "Requirement already satisfied: click>=8.0.0 in /usr/local/lib/python3.12/dist-packages (from typer-slim<1.0.0,>=0.3.0->spacy) (8.3.0)\n",
            "Requirement already satisfied: cloudpathlib<1.0.0,>=0.7.0 in /usr/local/lib/python3.12/dist-packages (from weasel<0.5.0,>=0.4.2->spacy) (0.23.0)\n",
            "Requirement already satisfied: smart-open<8.0.0,>=5.2.1 in /usr/local/lib/python3.12/dist-packages (from weasel<0.5.0,>=0.4.2->spacy) (7.5.0)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2->spacy) (3.0.3)\n",
            "Requirement already satisfied: wrapt in /usr/local/lib/python3.12/dist-packages (from smart-open<8.0.0,>=5.2.1->weasel<0.5.0,>=0.4.2->spacy) (2.0.1)\n",
            "Collecting en-core-web-sm==3.8.0\n",
            "  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.8.0/en_core_web_sm-3.8.0-py3-none-any.whl (12.8 MB)\n",
            "\u001b[2K     \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m12.8/12.8 MB\u001b[0m \u001b[31m101.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h\u001b[38;5;2m‚úî Download and installation successful\u001b[0m\n",
            "You can now load the package via spacy.load('en_core_web_sm')\n",
            "\u001b[38;5;3m‚ö† Restart to reload dependencies\u001b[0m\n",
            "If you are in a Jupyter or Colab notebook, you may need to restart Python in\n",
            "order to load all the package's dependencies. You can do this by selecting the\n",
            "'Restart kernel' or 'Restart runtime' option.\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import json\n",
        "import spacy\n",
        "import pandas as pd\n",
        "from tqdm.auto import tqdm\n",
        "\n",
        "nlp = spacy.load(\"en_core_web_sm\")\n",
        "# Use Python engine and warn on bad lines for more robust parsing of potentially malformed CSV\n",
        "nyt_raw = pd.read_csv(\"nyt_raw_all.csv\", engine='python', on_bad_lines='warn')\n",
        "len(nyt_raw)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hDZwz7pucj8N",
        "outputId": "2fdc686f-6ac6-4387-da5f-b00cff7598e8"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/tmp/ipython-input-1049375900.py:8: ParserWarning: Skipping line 11737: field larger than field limit (131072)\n",
            "\n",
            "  nyt_raw = pd.read_csv(\"nyt_raw_all.csv\", engine='python', on_bad_lines='warn')\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "34462"
            ]
          },
          "metadata": {},
          "execution_count": 3
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "2-1. Î¨∏Ïû• Îã®ÏúÑÎ°ú ÌéºÏπòÍ∏∞ Ìï®Ïàò"
      ],
      "metadata": {
        "id": "-JlnrJlHc0Mi"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "def build_news_posclean(df_raw: pd.DataFrame) -> pd.DataFrame:\n",
        "    rows = []\n",
        "\n",
        "    # spaCyÏùò nlp.pipeÎ°ú batch Ï≤òÎ¶¨ (ÏÜçÎèÑ Ìñ•ÏÉÅ)\n",
        "    texts = df_raw[\"raw_text\"].tolist()\n",
        "    docs = list(tqdm(nlp.pipe(texts, batch_size=16), total=len(texts)))\n",
        "\n",
        "    for (idx, row), doc in zip(df_raw.iterrows(), docs):\n",
        "        doc_id   = row[\"doc_id\"]\n",
        "        doc_type = \"news\"\n",
        "        date_str = row[\"date\"]\n",
        "        title    = row[\"title\"]\n",
        "        source   = row[\"source\"]\n",
        "        language = row[\"language\"]\n",
        "        raw_text = row[\"raw_text\"]\n",
        "\n",
        "        for sent_id, sent in enumerate(doc.sents):\n",
        "            text = sent.text.strip()\n",
        "            if not text:\n",
        "                continue\n",
        "\n",
        "            tokens = [t.text for t in sent]\n",
        "            pos_tags = [t.tag_ for t in sent]\n",
        "\n",
        "            # cleaned_text: stopword/Íµ¨ÎëêÏ†ê Ï†úÍ±∞ + ÏÜåÎ¨∏Ïûê + lemma\n",
        "            cleaned_tokens = [\n",
        "                t.lemma_.lower()\n",
        "                for t in sent\n",
        "                if not (t.is_stop or t.is_punct or t.is_space)\n",
        "            ]\n",
        "            cleaned_text = \" \".join(cleaned_tokens)\n",
        "\n",
        "            rows.append({\n",
        "                \"doc_id\": doc_id,\n",
        "                \"doc_type\": doc_type,\n",
        "                \"date\": date_str,\n",
        "                \"title\": title,\n",
        "                \"source\": source,\n",
        "                \"language\": language,\n",
        "                \"raw_text\": raw_text,\n",
        "                \"sent_id\": sent_id,\n",
        "                \"text\": text,\n",
        "                \"tokens\": json.dumps(tokens, ensure_ascii=False),\n",
        "                \"pos_tags\": json.dumps(pos_tags),\n",
        "                \"cleaned_text\": cleaned_text,\n",
        "            })\n",
        "\n",
        "    return pd.DataFrame(rows)"
      ],
      "metadata": {
        "id": "iETVSLoBcmEV"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        " news_posclean = build_news_posclean(nyt_raw)\n",
        "news_posclean.to_csv(\"news_posclean.csv\", index=False)\n",
        "news_posclean.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 766,
          "referenced_widgets": [
            "7fe67a75268c403bb0c18de0f3ab8a1d",
            "04ffbb6d86724eec87e58a2f1c69b5f5",
            "1257b0440e5f4524b6aa4769f6dec627",
            "1f3f1ae217cc42f3ac9e96a94caa58ec",
            "decb2b4483ee49228c18e3d4b6188891",
            "ed6155e34cd8466287ee9a8f087fa47d",
            "011e3ec966be4c129b3b096cf682e2c2",
            "a071bc3a4ece448cb05338759d38b87a",
            "c558b017dc334620b228e7773d2d90fb",
            "fd17c211b79740c891330905e9fbd691",
            "f56915ae876e48caaeb5bd9e5975a098"
          ]
        },
        "id": "MwelsRNac1lJ",
        "outputId": "19fa4089-16b9-44a8-cfe2-8b78effe1649"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "  0%|          | 0/34462 [00:00<?, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "7fe67a75268c403bb0c18de0f3ab8a1d"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                 doc_id doc_type        date                      title  \\\n",
              "0  NEWS_1993-01-31_6885     news  1993-01-31  Publishing At Their Peril   \n",
              "1  NEWS_1993-01-31_6885     news  1993-01-31  Publishing At Their Peril   \n",
              "2  NEWS_1993-01-31_6885     news  1993-01-31  Publishing At Their Peril   \n",
              "3  NEWS_1993-01-31_6885     news  1993-01-31  Publishing At Their Peril   \n",
              "4  NEWS_1993-01-31_6885     news  1993-01-31  Publishing At Their Peril   \n",
              "\n",
              "               source language  \\\n",
              "0  The New York Times       en   \n",
              "1  The New York Times       en   \n",
              "2  The New York Times       en   \n",
              "3  The New York Times       en   \n",
              "4  The New York Times       en   \n",
              "\n",
              "                                            raw_text  sent_id  \\\n",
              "0  Publishing At Their Peril Prime Minister John ...        0   \n",
              "1  Publishing At Their Peril Prime Minister John ...        1   \n",
              "2  Publishing At Their Peril Prime Minister John ...        2   \n",
              "3  Publishing At Their Peril Prime Minister John ...        3   \n",
              "4  Publishing At Their Peril Prime Minister John ...        4   \n",
              "\n",
              "                                                text  \\\n",
              "0  Publishing At Their Peril Prime Minister John ...   \n",
              "1  His response was unusual: he sued last week fo...   \n",
              "2  Prime Minister John Major is the latest Briton...   \n",
              "3  His response was unusual: he sued last week fo...   \n",
              "4  His willingness to fight two magazines reflect...   \n",
              "\n",
              "                                              tokens  \\\n",
              "0  [\"Publishing\", \"At\", \"Their\", \"Peril\", \"Prime\"...   \n",
              "1  [\"His\", \"response\", \"was\", \"unusual\", \":\", \"he...   \n",
              "2  [\"Prime\", \"Minister\", \"John\", \"Major\", \"is\", \"...   \n",
              "3  [\"His\", \"response\", \"was\", \"unusual\", \":\", \"he...   \n",
              "4  [\"His\", \"willingness\", \"to\", \"fight\", \"two\", \"...   \n",
              "\n",
              "                                            pos_tags  \\\n",
              "0  [\"VBG\", \"IN\", \"PRP$\", \"NNP\", \"NNP\", \"NNP\", \"NN...   \n",
              "1  [\"PRP$\", \"NN\", \"VBD\", \"JJ\", \":\", \"PRP\", \"VBD\",...   \n",
              "2  [\"NNP\", \"NNP\", \"NNP\", \"NNP\", \"VBZ\", \"DT\", \"JJS...   \n",
              "3  [\"PRP$\", \"NN\", \"VBD\", \"JJ\", \":\", \"PRP\", \"VBD\",...   \n",
              "4  [\"PRP$\", \"NN\", \"TO\", \"VB\", \"CD\", \"NNS\", \"VBD\",...   \n",
              "\n",
              "                                        cleaned_text  \n",
              "0  publish peril prime minister john major late b...  \n",
              "1                    response unusual sue week libel  \n",
              "2  prime minister john major late briton link pre...  \n",
              "3                    response unusual sue week libel  \n",
              "4  willingness fight magazine reflect grow intole...  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-be10b00c-ee7f-4e8a-86c3-522218f04a89\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>doc_id</th>\n",
              "      <th>doc_type</th>\n",
              "      <th>date</th>\n",
              "      <th>title</th>\n",
              "      <th>source</th>\n",
              "      <th>language</th>\n",
              "      <th>raw_text</th>\n",
              "      <th>sent_id</th>\n",
              "      <th>text</th>\n",
              "      <th>tokens</th>\n",
              "      <th>pos_tags</th>\n",
              "      <th>cleaned_text</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>NEWS_1993-01-31_6885</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-01-31</td>\n",
              "      <td>Publishing At Their Peril</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>0</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>[\"Publishing\", \"At\", \"Their\", \"Peril\", \"Prime\"...</td>\n",
              "      <td>[\"VBG\", \"IN\", \"PRP$\", \"NNP\", \"NNP\", \"NNP\", \"NN...</td>\n",
              "      <td>publish peril prime minister john major late b...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>NEWS_1993-01-31_6885</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-01-31</td>\n",
              "      <td>Publishing At Their Peril</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>1</td>\n",
              "      <td>His response was unusual: he sued last week fo...</td>\n",
              "      <td>[\"His\", \"response\", \"was\", \"unusual\", \":\", \"he...</td>\n",
              "      <td>[\"PRP$\", \"NN\", \"VBD\", \"JJ\", \":\", \"PRP\", \"VBD\",...</td>\n",
              "      <td>response unusual sue week libel</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>NEWS_1993-01-31_6885</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-01-31</td>\n",
              "      <td>Publishing At Their Peril</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>2</td>\n",
              "      <td>Prime Minister John Major is the latest Briton...</td>\n",
              "      <td>[\"Prime\", \"Minister\", \"John\", \"Major\", \"is\", \"...</td>\n",
              "      <td>[\"NNP\", \"NNP\", \"NNP\", \"NNP\", \"VBZ\", \"DT\", \"JJS...</td>\n",
              "      <td>prime minister john major late briton link pre...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>NEWS_1993-01-31_6885</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-01-31</td>\n",
              "      <td>Publishing At Their Peril</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>3</td>\n",
              "      <td>His response was unusual: he sued last week fo...</td>\n",
              "      <td>[\"His\", \"response\", \"was\", \"unusual\", \":\", \"he...</td>\n",
              "      <td>[\"PRP$\", \"NN\", \"VBD\", \"JJ\", \":\", \"PRP\", \"VBD\",...</td>\n",
              "      <td>response unusual sue week libel</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>NEWS_1993-01-31_6885</td>\n",
              "      <td>news</td>\n",
              "      <td>1993-01-31</td>\n",
              "      <td>Publishing At Their Peril</td>\n",
              "      <td>The New York Times</td>\n",
              "      <td>en</td>\n",
              "      <td>Publishing At Their Peril Prime Minister John ...</td>\n",
              "      <td>4</td>\n",
              "      <td>His willingness to fight two magazines reflect...</td>\n",
              "      <td>[\"His\", \"willingness\", \"to\", \"fight\", \"two\", \"...</td>\n",
              "      <td>[\"PRP$\", \"NN\", \"TO\", \"VB\", \"CD\", \"NNS\", \"VBD\",...</td>\n",
              "      <td>willingness fight magazine reflect grow intole...</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-be10b00c-ee7f-4e8a-86c3-522218f04a89')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-be10b00c-ee7f-4e8a-86c3-522218f04a89 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-be10b00c-ee7f-4e8a-86c3-522218f04a89');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-cce81afa-23f4-4f4e-8032-b86053372532\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-cce81afa-23f4-4f4e-8032-b86053372532')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-cce81afa-23f4-4f4e-8032-b86053372532 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "news_posclean"
            }
          },
          "metadata": {},
          "execution_count": 5
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive')"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9i_9iDMQc58Y",
        "outputId": "5ce4f511-d0a9-4554-8ad0-741b65aa8061"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import files\n",
        "files.download(\"news_posclean.csv\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 17
        },
        "id": "tr1N86RDJqt5",
        "outputId": "a1d98122-3a94-48ed-d238-0640b41b1315"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "\n",
              "    async function download(id, filename, size) {\n",
              "      if (!google.colab.kernel.accessAllowed) {\n",
              "        return;\n",
              "      }\n",
              "      const div = document.createElement('div');\n",
              "      const label = document.createElement('label');\n",
              "      label.textContent = `Downloading \"${filename}\": `;\n",
              "      div.appendChild(label);\n",
              "      const progress = document.createElement('progress');\n",
              "      progress.max = size;\n",
              "      div.appendChild(progress);\n",
              "      document.body.appendChild(div);\n",
              "\n",
              "      const buffers = [];\n",
              "      let downloaded = 0;\n",
              "\n",
              "      const channel = await google.colab.kernel.comms.open(id);\n",
              "      // Send a message to notify the kernel that we're ready.\n",
              "      channel.send({})\n",
              "\n",
              "      for await (const message of channel.messages) {\n",
              "        // Send a message to notify the kernel that we're ready.\n",
              "        channel.send({})\n",
              "        if (message.buffers) {\n",
              "          for (const buffer of message.buffers) {\n",
              "            buffers.push(buffer);\n",
              "            downloaded += buffer.byteLength;\n",
              "            progress.value = downloaded;\n",
              "          }\n",
              "        }\n",
              "      }\n",
              "      const blob = new Blob(buffers, {type: 'application/binary'});\n",
              "      const a = document.createElement('a');\n",
              "      a.href = window.URL.createObjectURL(blob);\n",
              "      a.download = filename;\n",
              "      div.appendChild(a);\n",
              "      a.click();\n",
              "      div.remove();\n",
              "    }\n",
              "  "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.Javascript object>"
            ],
            "application/javascript": [
              "download(\"download_2111ba4b-5dff-4f1a-b76e-d3d7e0c64f89\", \"news_posclean.csv\", 3195674515)"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "news_posclean.to_csv('/content/drive/MyDrive/news_posclean.csv', index=False)"
      ],
      "metadata": {
        "id": "3wgn8HJ0J_0a"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "\n",
        "samples = []\n",
        "for chunk in pd.read_csv(\"news_posclean.csv\", chunksize=100000, engine='python', on_bad_lines='warn'):\n",
        "    samples.append(chunk.sample(frac=0.01, random_state=42))  # 1% ÏÉòÌîå\n",
        "\n",
        "sample_df = pd.concat(samples, ignore_index=True)\n",
        "sample_df.to_csv(\"news_posclean_sample_1pct.csv\", index=False)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 350
        },
        "id": "23U4vXz_Q1qI",
        "outputId": "a603b87c-55bb-4392-c4cd-c9bdbf1415b3"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "error",
          "ename": "Error",
          "evalue": "unexpected end of data",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mError\u001b[0m                                     Traceback (most recent call last)",
            "\u001b[0;32m/tmp/ipython-input-3878077325.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0msamples\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0;32mfor\u001b[0m \u001b[0mchunk\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"news_posclean.csv\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mchunksize\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m100000\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mengine\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'python'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mon_bad_lines\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'warn'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m     \u001b[0msamples\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchunk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msample\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfrac\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0.01\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m42\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# 1% ÏÉòÌîå\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.12/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36m__next__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1841\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__next__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mDataFrame\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1842\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1843\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_chunk\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1844\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1845\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.12/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36mget_chunk\u001b[0;34m(self, size)\u001b[0m\n\u001b[1;32m   1983\u001b[0m                 \u001b[0;32mraise\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1984\u001b[0m             \u001b[0msize\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msize\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnrows\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_currow\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1985\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnrows\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1986\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1987\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__enter__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mSelf\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.12/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, nrows)\u001b[0m\n\u001b[1;32m   1921\u001b[0m                     \u001b[0mcolumns\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1922\u001b[0m                     \u001b[0mcol_dict\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1923\u001b[0;31m                 \u001b[0;34m)\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m  \u001b[0;31m# type: ignore[attr-defined]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1924\u001b[0m                     \u001b[0mnrows\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1925\u001b[0m                 )\n",
            "\u001b[0;32m/usr/local/lib/python3.12/dist-packages/pandas/io/parsers/python_parser.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, rows)\u001b[0m\n\u001b[1;32m    250\u001b[0m     ]:\n\u001b[1;32m    251\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 252\u001b[0;31m             \u001b[0mcontent\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_lines\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrows\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    253\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    254\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_first_chunk\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.12/dist-packages/pandas/io/parsers/python_parser.py\u001b[0m in \u001b[0;36m_get_lines\u001b[0;34m(self, rows)\u001b[0m\n\u001b[1;32m   1125\u001b[0m                             \u001b[0;31m# error in next\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1126\u001b[0m                             \u001b[0;32massert\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1127\u001b[0;31m                             \u001b[0mnew_row\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1128\u001b[0m                             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mskipfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moffset\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mrow_index\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1129\u001b[0m                                 \u001b[0mrow_ct\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mError\u001b[0m: unexpected end of data"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "iXumurxzSUg_"
      },
      "execution_count": null,
      "outputs": []
    }
  ]
}
